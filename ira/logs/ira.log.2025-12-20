2025-12-20 00:02:22,000 [INFO] app.main - Initialising Ira API application
2025-12-20 00:02:22,001 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 00:02:22,001 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 00:02:22,190 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 00:03:06,846 [INFO] app.main - Initialising Ira API application
2025-12-20 00:03:06,846 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 00:03:06,847 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 00:03:07,016 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 00:03:12,148 [INFO] app.main - Initialising Ira API application
2025-12-20 00:03:12,148 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 00:03:12,148 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 00:03:12,340 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 00:03:17,464 [INFO] app.main - Initialising Ira API application
2025-12-20 00:03:17,464 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 00:03:17,464 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 00:03:17,640 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 00:03:21,621 [INFO] app.main - Initialising Ira API application
2025-12-20 00:03:21,622 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 00:03:21,622 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 00:03:21,819 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 16:19:20,140 [INFO] app.main - Initialising Ira API application
2025-12-20 16:19:20,140 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 16:19:20,141 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 16:19:20,146 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 16:19:25,312 [INFO] app.main - Initialising Ira API application
2025-12-20 16:19:25,312 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 16:19:25,313 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 16:19:25,318 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 16:19:33,993 [INFO] app.main - Initialising Ira API application
2025-12-20 16:19:33,993 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 16:19:33,994 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 16:19:33,999 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 16:20:34,103 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 2443, in connect
    return await connect_utils._connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/connect_utils.py", line 1218, in _connect
    conn = await _connect_addr(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/connect_utils.py", line 1054, in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/connect_utils.py", line 1099, in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/connect_utils.py", line 969, in _create_ssl_connection
    tr, pr = await loop.create_connection(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 2033, in create_connection
  File "uvloop/loop.pyx", line 2020, in uvloop.loop.Loop.create_connection
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 60, in save_obj
    for (
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 223, in _organize_states_for_save
    for state, dict_, mapper, connection in _connections_for_states(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1759, in _connections_for_states
    connection = uowtransaction.transaction.connection(base_mapper)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in connection
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1037, in connection
    return self._connection_for_bind(bind, execution_options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1173, in _connection_for_bind
    conn = self._parent._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1187, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3285, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3309, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 630, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 955, in connect
    await_only(creator_fn(*arg, **kw)),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 2442, in connect
    async with compat.timeout(timeout):
  File "/usr/lib/python3.12/asyncio/timeouts.py", line 115, in __aexit__
    raise TimeoutError from exc_val
TimeoutError
2025-12-20 16:20:36,351 [INFO] app.main - Initialising Ira API application
2025-12-20 16:20:36,351 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 16:20:36,352 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 16:20:36,357 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 16:20:38,739 [INFO] app.main - Initialising Ira API application
2025-12-20 16:20:38,739 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 16:20:38,739 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 16:20:38,745 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 16:20:45,072 [INFO] app.main - Initialising Ira API application
2025-12-20 16:20:45,073 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 16:20:45,073 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 16:20:45,078 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 16:21:45,142 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 2443, in connect
    return await connect_utils._connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/connect_utils.py", line 1218, in _connect
    conn = await _connect_addr(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/connect_utils.py", line 1054, in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/connect_utils.py", line 1099, in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/connect_utils.py", line 969, in _create_ssl_connection
    tr, pr = await loop.create_connection(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 2033, in create_connection
  File "uvloop/loop.pyx", line 2020, in uvloop.loop.Loop.create_connection
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 60, in save_obj
    for (
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 223, in _organize_states_for_save
    for state, dict_, mapper, connection in _connections_for_states(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1759, in _connections_for_states
    connection = uowtransaction.transaction.connection(base_mapper)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in connection
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1037, in connection
    return self._connection_for_bind(bind, execution_options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1173, in _connection_for_bind
    conn = self._parent._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1187, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3285, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3309, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 630, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 955, in connect
    await_only(creator_fn(*arg, **kw)),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 2442, in connect
    async with compat.timeout(timeout):
  File "/usr/lib/python3.12/asyncio/timeouts.py", line 115, in __aexit__
    raise TimeoutError from exc_val
TimeoutError
2025-12-20 16:21:50,299 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 21, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 21, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 21, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 21, 50, 147749, tzinfo=datetime.timezone.utc), 'cpu.total', 1.230000000000004, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 21, 50, 147749, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 21, 50, 147749, tzinfo=datetime.timezone.utc), 'cpu.system', 1.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 21, 50, 147749, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.77, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 21, 50, 147749, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4313072, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 21, 50, 147749, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22494764, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 21, 50, 147749, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.95, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 21, 50, 147749, tzinfo=datetime.timezone.utc), 'load.1m', 1.55, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 21, 50, 147749, tzinfo=datetime.timezone.utc), 'load.5m', 0.53, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 21, 50, 147749, tzinfo=datetime.timezone.utc), 'load.15m', 0.24, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:21:55,447 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 21, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 21, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 21, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 21, 55, 343916, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 21, 55, 343916, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 21, 55, 343916, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 21, 55, 343916, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 21, 55, 343916, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4319504, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 21, 55, 343916, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22483648, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 21, 55, 343916, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.93, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 21, 55, 343916, tzinfo=datetime.timezone.utc), 'load.1m', 1.43, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 21, 55, 343916, tzinfo=datetime.timezone.utc), 'load.5m', 0.53, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 21, 55, 343916, tzinfo=datetime.timezone.utc), 'load.15m', 0.24, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:22:00,554 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 22, 0, 451517, tzinfo=datetime.timezone.utc), 'cpu.total', 1.269999999999996, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 0, 451517, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 0, 451517, tzinfo=datetime.timezone.utc), 'cpu.system', 1.27, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 0, 451517, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.73, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 0, 451517, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4327740, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 0, 451517, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22475176, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 0, 451517, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.9, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 0, 451517, tzinfo=datetime.timezone.utc), 'load.1m', 1.31, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 0, 451517, tzinfo=datetime.timezone.utc), 'load.5m', 0.52, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 0, 451517, tzinfo=datetime.timezone.utc), 'load.15m', 0.24, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:22:05,661 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 22, 5, 558426, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 5, 558426, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 5, 558426, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 5, 558426, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 5, 558426, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4331512, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 5, 558426, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22471396, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 5, 558426, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.89, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 5, 558426, tzinfo=datetime.timezone.utc), 'load.1m', 1.21, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 5, 558426, tzinfo=datetime.timezone.utc), 'load.5m', 0.51, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 5, 558426, tzinfo=datetime.timezone.utc), 'load.15m', 0.24, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:22:10,768 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 22, 10, 664612, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 10, 664612, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 10, 664612, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 10, 664612, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 10, 664612, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4348744, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 10, 664612, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22454156, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 10, 664612, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.83, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 10, 664612, tzinfo=datetime.timezone.utc), 'load.1m', 1.11, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 10, 664612, tzinfo=datetime.timezone.utc), 'load.5m', 0.5, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 10, 664612, tzinfo=datetime.timezone.utc), 'load.15m', 0.24, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:22:15,872 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 22, 15, 769778, tzinfo=datetime.timezone.utc), 'cpu.total', 1.230000000000004, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 15, 769778, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 15, 769778, tzinfo=datetime.timezone.utc), 'cpu.system', 1.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 15, 769778, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.77, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 15, 769778, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4348468, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 15, 769778, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22453256, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 15, 769778, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.82, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 15, 769778, tzinfo=datetime.timezone.utc), 'load.1m', 1.02, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 15, 769778, tzinfo=datetime.timezone.utc), 'load.5m', 0.49, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 15, 769778, tzinfo=datetime.timezone.utc), 'load.15m', 0.24, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:22:20,979 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 22, 20, 875388, tzinfo=datetime.timezone.utc), 'cpu.total', 3.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 20, 875388, tzinfo=datetime.timezone.utc), 'cpu.user', 2.5, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 20, 875388, tzinfo=datetime.timezone.utc), 'cpu.system', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 20, 875388, tzinfo=datetime.timezone.utc), 'cpu.idle', 96.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 20, 875388, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4355128, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 20, 875388, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22446588, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 20, 875388, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.8, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 20, 875388, tzinfo=datetime.timezone.utc), 'load.1m', 0.94, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 20, 875388, tzinfo=datetime.timezone.utc), 'load.5m', 0.48, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 20, 875388, tzinfo=datetime.timezone.utc), 'load.15m', 0.23, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:22:26,086 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 22, 25, 982486, tzinfo=datetime.timezone.utc), 'cpu.total', 3.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 25, 982486, tzinfo=datetime.timezone.utc), 'cpu.user', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 25, 982486, tzinfo=datetime.timezone.utc), 'cpu.system', 2.5, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 25, 982486, tzinfo=datetime.timezone.utc), 'cpu.idle', 96.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 25, 982486, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4356156, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 25, 982486, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22439720, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 25, 982486, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.8, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 25, 982486, tzinfo=datetime.timezone.utc), 'load.1m', 0.87, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 25, 982486, tzinfo=datetime.timezone.utc), 'load.5m', 0.47, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 25, 982486, tzinfo=datetime.timezone.utc), 'load.15m', 0.23, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:22:31,193 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 22, 31, 88827, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 31, 88827, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 31, 88827, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 31, 88827, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 31, 88827, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4369788, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 31, 88827, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22426024, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 31, 88827, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 31, 88827, tzinfo=datetime.timezone.utc), 'load.1m', 0.8, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 31, 88827, tzinfo=datetime.timezone.utc), 'load.5m', 0.47, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 31, 88827, tzinfo=datetime.timezone.utc), 'load.15m', 0.23, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:22:36,301 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 22, 36, 197768, tzinfo=datetime.timezone.utc), 'cpu.total', 1.230000000000004, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 36, 197768, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 36, 197768, tzinfo=datetime.timezone.utc), 'cpu.system', 1.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 36, 197768, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.77, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 36, 197768, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4370732, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 36, 197768, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22425060, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 36, 197768, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 36, 197768, tzinfo=datetime.timezone.utc), 'load.1m', 0.73, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 36, 197768, tzinfo=datetime.timezone.utc), 'load.5m', 0.46, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 36, 197768, tzinfo=datetime.timezone.utc), 'load.15m', 0.23, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:22:41,407 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 22, 41, 304147, tzinfo=datetime.timezone.utc), 'cpu.total', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 41, 304147, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 41, 304147, tzinfo=datetime.timezone.utc), 'cpu.system', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 41, 304147, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 41, 304147, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4370672, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 41, 304147, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22425076, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 41, 304147, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 41, 304147, tzinfo=datetime.timezone.utc), 'load.1m', 0.67, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 41, 304147, tzinfo=datetime.timezone.utc), 'load.5m', 0.45, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 41, 304147, tzinfo=datetime.timezone.utc), 'load.15m', 0.23, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:22:46,514 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 22, 46, 410721, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 46, 410721, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 46, 410721, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 46, 410721, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 46, 410721, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4369336, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 46, 410721, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22426392, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 46, 410721, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 46, 410721, tzinfo=datetime.timezone.utc), 'load.1m', 0.62, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 46, 410721, tzinfo=datetime.timezone.utc), 'load.5m', 0.44, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 46, 410721, tzinfo=datetime.timezone.utc), 'load.15m', 0.23, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:22:51,621 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 22, 51, 516450, tzinfo=datetime.timezone.utc), 'cpu.total', 3.6099999999999994, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 51, 516450, tzinfo=datetime.timezone.utc), 'cpu.user', 2.41, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 51, 516450, tzinfo=datetime.timezone.utc), 'cpu.system', 1.2, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 51, 516450, tzinfo=datetime.timezone.utc), 'cpu.idle', 96.39, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 51, 516450, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4368828, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 51, 516450, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22426872, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 51, 516450, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.76, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 51, 516450, tzinfo=datetime.timezone.utc), 'load.1m', 0.57, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 51, 516450, tzinfo=datetime.timezone.utc), 'load.5m', 0.43, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 51, 516450, tzinfo=datetime.timezone.utc), 'load.15m', 0.22, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:22:56,729 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 22, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 22, 56, 625342, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 56, 625342, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 56, 625342, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 56, 625342, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 56, 625342, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4369432, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 56, 625342, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22426240, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 56, 625342, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 56, 625342, tzinfo=datetime.timezone.utc), 'load.1m', 0.52, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 56, 625342, tzinfo=datetime.timezone.utc), 'load.5m', 0.43, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 22, 56, 625342, tzinfo=datetime.timezone.utc), 'load.15m', 0.22, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:23:01,836 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 23, 1, 733440, tzinfo=datetime.timezone.utc), 'cpu.total', 2.5, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 1, 733440, tzinfo=datetime.timezone.utc), 'cpu.user', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 1, 733440, tzinfo=datetime.timezone.utc), 'cpu.system', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 1, 733440, tzinfo=datetime.timezone.utc), 'cpu.idle', 97.5, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 1, 733440, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4371528, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 1, 733440, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22424144, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 1, 733440, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 1, 733440, tzinfo=datetime.timezone.utc), 'load.1m', 0.48, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 1, 733440, tzinfo=datetime.timezone.utc), 'load.5m', 0.42, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 1, 733440, tzinfo=datetime.timezone.utc), 'load.15m', 0.22, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:23:06,941 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 23, 6, 838549, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 6, 838549, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 6, 838549, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 6, 838549, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 6, 838549, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4371088, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 6, 838549, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22424584, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 6, 838549, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 6, 838549, tzinfo=datetime.timezone.utc), 'load.1m', 0.44, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 6, 838549, tzinfo=datetime.timezone.utc), 'load.5m', 0.41, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 6, 838549, tzinfo=datetime.timezone.utc), 'load.15m', 0.22, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:23:12,046 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 23, 11, 943784, tzinfo=datetime.timezone.utc), 'cpu.total', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 11, 943784, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 11, 943784, tzinfo=datetime.timezone.utc), 'cpu.system', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 11, 943784, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 11, 943784, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4375972, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 11, 943784, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22419700, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 11, 943784, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.73, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 11, 943784, tzinfo=datetime.timezone.utc), 'load.1m', 0.41, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 11, 943784, tzinfo=datetime.timezone.utc), 'load.5m', 0.41, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 11, 943784, tzinfo=datetime.timezone.utc), 'load.15m', 0.22, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:23:17,151 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 23, 17, 48823, tzinfo=datetime.timezone.utc), 'cpu.total', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 17, 48823, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 17, 48823, tzinfo=datetime.timezone.utc), 'cpu.system', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 17, 48823, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 17, 48823, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4372536, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 17, 48823, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22423120, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 17, 48823, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.74, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 17, 48823, tzinfo=datetime.timezone.utc), 'load.1m', 0.37, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 17, 48823, tzinfo=datetime.timezone.utc), 'load.5m', 0.4, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 17, 48823, tzinfo=datetime.timezone.utc), 'load.15m', 0.22, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:23:22,258 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 23, 22, 154248, tzinfo=datetime.timezone.utc), 'cpu.total', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 22, 154248, tzinfo=datetime.timezone.utc), 'cpu.user', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 22, 154248, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 22, 154248, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 22, 154248, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4371484, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 22, 154248, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22424144, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 22, 154248, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 22, 154248, tzinfo=datetime.timezone.utc), 'load.1m', 0.34, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 22, 154248, tzinfo=datetime.timezone.utc), 'load.5m', 0.39, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 22, 154248, tzinfo=datetime.timezone.utc), 'load.15m', 0.22, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:23:27,364 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 23, 27, 260412, tzinfo=datetime.timezone.utc), 'cpu.total', 14.099999999999994, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 27, 260412, tzinfo=datetime.timezone.utc), 'cpu.user', 6.41, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 27, 260412, tzinfo=datetime.timezone.utc), 'cpu.system', 6.41, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 27, 260412, tzinfo=datetime.timezone.utc), 'cpu.idle', 85.9, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 27, 260412, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4374372, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 27, 260412, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22420724, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 27, 260412, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.74, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 27, 260412, tzinfo=datetime.timezone.utc), 'load.1m', 0.32, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 27, 260412, tzinfo=datetime.timezone.utc), 'load.5m', 0.38, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 27, 260412, tzinfo=datetime.timezone.utc), 'load.15m', 0.21, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:23:32,473 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 23, 32, 368126, tzinfo=datetime.timezone.utc), 'cpu.total', 2.469999999999999, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 32, 368126, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 32, 368126, tzinfo=datetime.timezone.utc), 'cpu.system', 2.47, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 32, 368126, tzinfo=datetime.timezone.utc), 'cpu.idle', 97.53, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 32, 368126, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4376800, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 32, 368126, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22418276, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 32, 368126, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.73, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 32, 368126, tzinfo=datetime.timezone.utc), 'load.1m', 0.29, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 32, 368126, tzinfo=datetime.timezone.utc), 'load.5m', 0.38, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 32, 368126, tzinfo=datetime.timezone.utc), 'load.15m', 0.21, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:23:37,578 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 23, 37, 475604, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 37, 475604, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 37, 475604, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 37, 475604, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 37, 475604, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4370008, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 37, 475604, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22425052, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 37, 475604, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 37, 475604, tzinfo=datetime.timezone.utc), 'load.1m', 0.35, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 37, 475604, tzinfo=datetime.timezone.utc), 'load.5m', 0.39, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 37, 475604, tzinfo=datetime.timezone.utc), 'load.15m', 0.22, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:23:42,685 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 23, 42, 581722, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 42, 581722, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 42, 581722, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 42, 581722, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 42, 581722, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4370616, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 42, 581722, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22424428, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 42, 581722, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 42, 581722, tzinfo=datetime.timezone.utc), 'load.1m', 0.32, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 42, 581722, tzinfo=datetime.timezone.utc), 'load.5m', 0.38, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 42, 581722, tzinfo=datetime.timezone.utc), 'load.15m', 0.22, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:23:47,790 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 23, 47, 687726, tzinfo=datetime.timezone.utc), 'cpu.total', 1.230000000000004, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 47, 687726, tzinfo=datetime.timezone.utc), 'cpu.user', 1.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 47, 687726, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 47, 687726, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.77, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 47, 687726, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4367260, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 47, 687726, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22427764, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 47, 687726, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.76, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 47, 687726, tzinfo=datetime.timezone.utc), 'load.1m', 0.29, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 47, 687726, tzinfo=datetime.timezone.utc), 'load.5m', 0.38, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 47, 687726, tzinfo=datetime.timezone.utc), 'load.15m', 0.21, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:23:52,896 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 23, 52, 793519, tzinfo=datetime.timezone.utc), 'cpu.total', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 52, 793519, tzinfo=datetime.timezone.utc), 'cpu.user', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 52, 793519, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 52, 793519, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 52, 793519, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4371272, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 52, 793519, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22423740, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 52, 793519, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 52, 793519, tzinfo=datetime.timezone.utc), 'load.1m', 0.27, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 52, 793519, tzinfo=datetime.timezone.utc), 'load.5m', 0.37, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 52, 793519, tzinfo=datetime.timezone.utc), 'load.15m', 0.21, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:23:58,001 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 23, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 23, 57, 898661, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 57, 898661, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 57, 898661, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 57, 898661, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 57, 898661, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4365424, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 57, 898661, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22429520, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 57, 898661, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.77, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 57, 898661, tzinfo=datetime.timezone.utc), 'load.1m', 0.41, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 57, 898661, tzinfo=datetime.timezone.utc), 'load.5m', 0.4, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 23, 57, 898661, tzinfo=datetime.timezone.utc), 'load.15m', 0.22, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:24:03,107 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 24, 3, 3633, tzinfo=datetime.timezone.utc), 'cpu.total', 1.230000000000004, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 3, 3633, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 3, 3633, tzinfo=datetime.timezone.utc), 'cpu.system', 1.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 3, 3633, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.77, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 3, 3633, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4370028, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 3, 3633, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22424908, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 3, 3633, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 3, 3633, tzinfo=datetime.timezone.utc), 'load.1m', 0.38, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 3, 3633, tzinfo=datetime.timezone.utc), 'load.5m', 0.39, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 3, 3633, tzinfo=datetime.timezone.utc), 'load.15m', 0.22, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:24:08,213 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 24, 8, 109442, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 8, 109442, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 8, 109442, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 8, 109442, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 8, 109442, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4368280, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 8, 109442, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22426648, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 8, 109442, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.76, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 8, 109442, tzinfo=datetime.timezone.utc), 'load.1m', 0.35, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 8, 109442, tzinfo=datetime.timezone.utc), 'load.5m', 0.38, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 8, 109442, tzinfo=datetime.timezone.utc), 'load.15m', 0.22, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:24:13,320 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 24, 13, 215872, tzinfo=datetime.timezone.utc), 'cpu.total', 2.5, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 13, 215872, tzinfo=datetime.timezone.utc), 'cpu.user', 2.5, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 13, 215872, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 13, 215872, tzinfo=datetime.timezone.utc), 'cpu.idle', 97.5, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 13, 215872, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4371604, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 13, 215872, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22423304, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 13, 215872, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 13, 215872, tzinfo=datetime.timezone.utc), 'load.1m', 0.32, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 13, 215872, tzinfo=datetime.timezone.utc), 'load.5m', 0.38, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 13, 215872, tzinfo=datetime.timezone.utc), 'load.15m', 0.22, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:24:18,426 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 24, 18, 323255, tzinfo=datetime.timezone.utc), 'cpu.total', 2.469999999999999, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 18, 323255, tzinfo=datetime.timezone.utc), 'cpu.user', 1.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 18, 323255, tzinfo=datetime.timezone.utc), 'cpu.system', 1.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 18, 323255, tzinfo=datetime.timezone.utc), 'cpu.idle', 97.53, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 18, 323255, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4384896, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 18, 323255, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22409996, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 18, 323255, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.7, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 18, 323255, tzinfo=datetime.timezone.utc), 'load.1m', 0.29, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 18, 323255, tzinfo=datetime.timezone.utc), 'load.5m', 0.37, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 18, 323255, tzinfo=datetime.timezone.utc), 'load.15m', 0.22, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:24:23,531 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 24, 23, 426880, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 23, 426880, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 23, 426880, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 23, 426880, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 23, 426880, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4381088, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 23, 426880, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22413212, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 23, 426880, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.71, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 23, 426880, tzinfo=datetime.timezone.utc), 'load.1m', 0.27, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 23, 426880, tzinfo=datetime.timezone.utc), 'load.5m', 0.36, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 23, 426880, tzinfo=datetime.timezone.utc), 'load.15m', 0.22, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:24:28,636 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 24, 28, 533955, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 28, 533955, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 28, 533955, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 28, 533955, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 28, 533955, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4374704, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 28, 533955, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22419284, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 28, 533955, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.74, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 28, 533955, tzinfo=datetime.timezone.utc), 'load.1m', 0.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 28, 533955, tzinfo=datetime.timezone.utc), 'load.5m', 0.36, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 28, 533955, tzinfo=datetime.timezone.utc), 'load.15m', 0.21, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:24:33,744 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 24, 33, 639402, tzinfo=datetime.timezone.utc), 'cpu.total', 2.5, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 33, 639402, tzinfo=datetime.timezone.utc), 'cpu.user', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 33, 639402, tzinfo=datetime.timezone.utc), 'cpu.system', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 33, 639402, tzinfo=datetime.timezone.utc), 'cpu.idle', 97.5, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 33, 639402, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4380268, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 33, 639402, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22413704, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 33, 639402, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.72, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 33, 639402, tzinfo=datetime.timezone.utc), 'load.1m', 0.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 33, 639402, tzinfo=datetime.timezone.utc), 'load.5m', 0.35, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 33, 639402, tzinfo=datetime.timezone.utc), 'load.15m', 0.21, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:24:38,849 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 24, 38, 746210, tzinfo=datetime.timezone.utc), 'cpu.total', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 38, 746210, tzinfo=datetime.timezone.utc), 'cpu.user', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 38, 746210, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 38, 746210, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 38, 746210, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4379060, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 38, 746210, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22414896, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 38, 746210, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.72, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 38, 746210, tzinfo=datetime.timezone.utc), 'load.1m', 0.21, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 38, 746210, tzinfo=datetime.timezone.utc), 'load.5m', 0.34, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 38, 746210, tzinfo=datetime.timezone.utc), 'load.15m', 0.21, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:24:43,955 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 24, 43, 851632, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 43, 851632, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 43, 851632, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 43, 851632, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 43, 851632, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4380144, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 43, 851632, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22413400, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 43, 851632, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.72, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 43, 851632, tzinfo=datetime.timezone.utc), 'load.1m', 0.19, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 43, 851632, tzinfo=datetime.timezone.utc), 'load.5m', 0.34, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 43, 851632, tzinfo=datetime.timezone.utc), 'load.15m', 0.21, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:24:49,061 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 24, 48, 957835, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 48, 957835, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 48, 957835, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 48, 957835, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 48, 957835, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4375028, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 48, 957835, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22418500, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 48, 957835, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.73, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 48, 957835, tzinfo=datetime.timezone.utc), 'load.1m', 0.26, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 48, 957835, tzinfo=datetime.timezone.utc), 'load.5m', 0.35, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 48, 957835, tzinfo=datetime.timezone.utc), 'load.15m', 0.21, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:24:54,167 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 24, 54, 64011, tzinfo=datetime.timezone.utc), 'cpu.total', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 54, 64011, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 54, 64011, tzinfo=datetime.timezone.utc), 'cpu.system', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 54, 64011, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 54, 64011, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4381172, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 54, 64011, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22412340, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 54, 64011, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.71, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 54, 64011, tzinfo=datetime.timezone.utc), 'load.1m', 0.24, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 54, 64011, tzinfo=datetime.timezone.utc), 'load.5m', 0.34, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 54, 64011, tzinfo=datetime.timezone.utc), 'load.15m', 0.21, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:24:59,273 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 24, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 24, 59, 170027, tzinfo=datetime.timezone.utc), 'cpu.total', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 59, 170027, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 59, 170027, tzinfo=datetime.timezone.utc), 'cpu.system', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 59, 170027, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 59, 170027, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4379052, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 59, 170027, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22414384, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 59, 170027, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.72, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 59, 170027, tzinfo=datetime.timezone.utc), 'load.1m', 0.22, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 59, 170027, tzinfo=datetime.timezone.utc), 'load.5m', 0.34, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 24, 59, 170027, tzinfo=datetime.timezone.utc), 'load.15m', 0.21, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:25:04,379 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 25, 4, 276283, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 4, 276283, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 4, 276283, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 4, 276283, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 4, 276283, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4383744, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 4, 276283, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22409668, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 4, 276283, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.7, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 4, 276283, tzinfo=datetime.timezone.utc), 'load.1m', 0.2, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 4, 276283, tzinfo=datetime.timezone.utc), 'load.5m', 0.33, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 4, 276283, tzinfo=datetime.timezone.utc), 'load.15m', 0.21, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:25:09,485 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 25, 9, 381893, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 9, 381893, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 9, 381893, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 9, 381893, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 9, 381893, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4382976, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 9, 381893, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22410416, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 9, 381893, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.71, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 9, 381893, tzinfo=datetime.timezone.utc), 'load.1m', 0.18, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 9, 381893, tzinfo=datetime.timezone.utc), 'load.5m', 0.33, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 9, 381893, tzinfo=datetime.timezone.utc), 'load.15m', 0.21, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:25:14,591 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 25, 14, 487980, tzinfo=datetime.timezone.utc), 'cpu.total', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 14, 487980, tzinfo=datetime.timezone.utc), 'cpu.user', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 14, 487980, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 14, 487980, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 14, 487980, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4386936, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 14, 487980, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22406432, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 14, 487980, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.69, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 14, 487980, tzinfo=datetime.timezone.utc), 'load.1m', 0.33, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 14, 487980, tzinfo=datetime.timezone.utc), 'load.5m', 0.35, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 14, 487980, tzinfo=datetime.timezone.utc), 'load.15m', 0.22, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:25:19,697 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 25, 19, 594080, tzinfo=datetime.timezone.utc), 'cpu.total', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 19, 594080, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 19, 594080, tzinfo=datetime.timezone.utc), 'cpu.system', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 19, 594080, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 19, 594080, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4382784, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 19, 594080, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22410564, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 19, 594080, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.71, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 19, 594080, tzinfo=datetime.timezone.utc), 'load.1m', 0.28, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 19, 594080, tzinfo=datetime.timezone.utc), 'load.5m', 0.34, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 19, 594080, tzinfo=datetime.timezone.utc), 'load.15m', 0.22, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:25:24,802 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 25, 24, 698196, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 24, 698196, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 24, 698196, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 24, 698196, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 24, 698196, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4384700, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 24, 698196, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22408628, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 24, 698196, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.7, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 24, 698196, tzinfo=datetime.timezone.utc), 'load.1m', 0.26, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 24, 698196, tzinfo=datetime.timezone.utc), 'load.5m', 0.34, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 24, 698196, tzinfo=datetime.timezone.utc), 'load.15m', 0.21, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:25:29,910 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 25, 29, 805867, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 29, 805867, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 29, 805867, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 29, 805867, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 29, 805867, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4376204, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 29, 805867, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22417084, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 29, 805867, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.73, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 29, 805867, tzinfo=datetime.timezone.utc), 'load.1m', 0.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 29, 805867, tzinfo=datetime.timezone.utc), 'load.5m', 0.33, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 29, 805867, tzinfo=datetime.timezone.utc), 'load.15m', 0.21, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:25:35,015 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 25, 34, 912148, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 34, 912148, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 34, 912148, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 34, 912148, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 34, 912148, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4378936, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 34, 912148, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22414344, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 34, 912148, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.72, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 34, 912148, tzinfo=datetime.timezone.utc), 'load.1m', 0.22, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 34, 912148, tzinfo=datetime.timezone.utc), 'load.5m', 0.32, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 34, 912148, tzinfo=datetime.timezone.utc), 'load.15m', 0.21, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:25:40,121 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 25, 40, 18070, tzinfo=datetime.timezone.utc), 'cpu.total', 1.269999999999996, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 40, 18070, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 40, 18070, tzinfo=datetime.timezone.utc), 'cpu.system', 1.27, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 40, 18070, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.73, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 40, 18070, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4379512, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 40, 18070, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22413740, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 40, 18070, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.72, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 40, 18070, tzinfo=datetime.timezone.utc), 'load.1m', 0.2, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 40, 18070, tzinfo=datetime.timezone.utc), 'load.5m', 0.32, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 40, 18070, tzinfo=datetime.timezone.utc), 'load.15m', 0.21, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:25:45,226 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 25, 45, 123549, tzinfo=datetime.timezone.utc), 'cpu.total', 2.5, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 45, 123549, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 45, 123549, tzinfo=datetime.timezone.utc), 'cpu.system', 2.5, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 45, 123549, tzinfo=datetime.timezone.utc), 'cpu.idle', 97.5, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 45, 123549, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4381228, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 45, 123549, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22412004, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 45, 123549, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.71, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 45, 123549, tzinfo=datetime.timezone.utc), 'load.1m', 0.18, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 45, 123549, tzinfo=datetime.timezone.utc), 'load.5m', 0.31, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 45, 123549, tzinfo=datetime.timezone.utc), 'load.15m', 0.21, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:25:50,333 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 25, 50, 229802, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 50, 229802, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 50, 229802, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 50, 229802, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 50, 229802, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4383220, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 50, 229802, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22409112, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 50, 229802, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.7, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 50, 229802, tzinfo=datetime.timezone.utc), 'load.1m', 0.17, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 50, 229802, tzinfo=datetime.timezone.utc), 'load.5m', 0.31, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 50, 229802, tzinfo=datetime.timezone.utc), 'load.15m', 0.21, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:25:55,438 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 25, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 25, 55, 335359, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 55, 335359, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 55, 335359, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 55, 335359, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 55, 335359, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4387724, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 55, 335359, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22404588, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 55, 335359, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.69, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 55, 335359, tzinfo=datetime.timezone.utc), 'load.1m', 0.15, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 55, 335359, tzinfo=datetime.timezone.utc), 'load.5m', 0.3, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 25, 55, 335359, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:26:00,544 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 26, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 26, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 26, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 26, 0, 441029, tzinfo=datetime.timezone.utc), 'cpu.total', 1.230000000000004, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 0, 441029, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 0, 441029, tzinfo=datetime.timezone.utc), 'cpu.system', 1.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 0, 441029, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.77, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 0, 441029, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4393456, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 0, 441029, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22396812, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 0, 441029, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.67, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 0, 441029, tzinfo=datetime.timezone.utc), 'load.1m', 0.14, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 0, 441029, tzinfo=datetime.timezone.utc), 'load.5m', 0.3, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 0, 441029, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:26:05,651 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 26, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 26, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 26, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 26, 5, 547276, tzinfo=datetime.timezone.utc), 'cpu.total', 2.469999999999999, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 5, 547276, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 5, 547276, tzinfo=datetime.timezone.utc), 'cpu.system', 2.47, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 5, 547276, tzinfo=datetime.timezone.utc), 'cpu.idle', 97.53, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 5, 547276, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4395760, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 5, 547276, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22394500, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 5, 547276, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.66, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 5, 547276, tzinfo=datetime.timezone.utc), 'load.1m', 0.21, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 5, 547276, tzinfo=datetime.timezone.utc), 'load.5m', 0.31, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 5, 547276, tzinfo=datetime.timezone.utc), 'load.15m', 0.21, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:26:10,758 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 26, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 26, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 26, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 26, 10, 653324, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 10, 653324, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 10, 653324, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 10, 653324, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 10, 653324, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4395064, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 10, 653324, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22395180, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 10, 653324, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.66, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 10, 653324, tzinfo=datetime.timezone.utc), 'load.1m', 0.19, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 10, 653324, tzinfo=datetime.timezone.utc), 'load.5m', 0.3, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 10, 653324, tzinfo=datetime.timezone.utc), 'load.15m', 0.21, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:26:15,865 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 26, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 26, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 26, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 26, 15, 760690, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 15, 760690, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 15, 760690, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 15, 760690, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 15, 760690, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4396104, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 15, 760690, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22394120, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 15, 760690, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.66, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 15, 760690, tzinfo=datetime.timezone.utc), 'load.1m', 0.18, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 15, 760690, tzinfo=datetime.timezone.utc), 'load.5m', 0.3, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 15, 760690, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:26:20,972 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 26, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 26, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 26, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 26, 20, 869251, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 20, 869251, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 20, 869251, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 20, 869251, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 20, 869251, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4397972, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 20, 869251, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22392224, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 20, 869251, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.65, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 20, 869251, tzinfo=datetime.timezone.utc), 'load.1m', 0.16, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 20, 869251, tzinfo=datetime.timezone.utc), 'load.5m', 0.29, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 20, 869251, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:26:22,986 [INFO] app.modules.logs.reader - Reading last 200 lines from log file /home/markus/projects/IRANet/ira/logs/ira.log
2025-12-20 16:26:22,987 [INFO] app.modules.logs.reader - Read 7575 lines from log file /home/markus/projects/IRANet/ira/logs/ira.log
2025-12-20 16:26:26,077 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 26, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 26, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 26, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 26, 25, 973042, tzinfo=datetime.timezone.utc), 'cpu.total', 2.469999999999999, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 25, 973042, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 25, 973042, tzinfo=datetime.timezone.utc), 'cpu.system', 2.47, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 25, 973042, tzinfo=datetime.timezone.utc), 'cpu.idle', 97.53, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 25, 973042, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4396380, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 25, 973042, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22393796, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 25, 973042, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.66, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 25, 973042, tzinfo=datetime.timezone.utc), 'load.1m', 0.15, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 25, 973042, tzinfo=datetime.timezone.utc), 'load.5m', 0.29, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 26, 25, 973042, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:29:50,961 [INFO] app.main - Initialising Ira API application
2025-12-20 16:29:50,961 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 16:29:50,961 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 16:29:50,969 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 16:29:51,112 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 29, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 29, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 29, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 29, 50, 969476, tzinfo=datetime.timezone.utc), 'cpu.total', 6.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 29, 50, 969476, tzinfo=datetime.timezone.utc), 'cpu.user', 3.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 29, 50, 969476, tzinfo=datetime.timezone.utc), 'cpu.system', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 29, 50, 969476, tzinfo=datetime.timezone.utc), 'cpu.idle', 93.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 29, 50, 969476, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4303620, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 29, 50, 969476, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22463264, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 29, 50, 969476, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.98, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 29, 50, 969476, tzinfo=datetime.timezone.utc), 'load.1m', 0.08, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 29, 50, 969476, tzinfo=datetime.timezone.utc), 'load.5m', 0.24, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 29, 50, 969476, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:29:56,220 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 29, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 29, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 29, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 29, 56, 116970, tzinfo=datetime.timezone.utc), 'cpu.total', 1.230000000000004, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 29, 56, 116970, tzinfo=datetime.timezone.utc), 'cpu.user', 1.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 29, 56, 116970, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 29, 56, 116970, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.77, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 29, 56, 116970, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4321240, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 29, 56, 116970, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22445624, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 29, 56, 116970, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.92, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 29, 56, 116970, tzinfo=datetime.timezone.utc), 'load.1m', 0.07, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 29, 56, 116970, tzinfo=datetime.timezone.utc), 'load.5m', 0.24, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 29, 56, 116970, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:30:01,328 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 30, 1, 223820, tzinfo=datetime.timezone.utc), 'cpu.total', 8.540000000000006, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 1, 223820, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 1, 223820, tzinfo=datetime.timezone.utc), 'cpu.system', 6.1, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 1, 223820, tzinfo=datetime.timezone.utc), 'cpu.idle', 91.46, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 1, 223820, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4324372, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 1, 223820, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22442468, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 1, 223820, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.91, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 1, 223820, tzinfo=datetime.timezone.utc), 'load.1m', 0.15, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 1, 223820, tzinfo=datetime.timezone.utc), 'load.5m', 0.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 1, 223820, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:30:06,433 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 30, 6, 330497, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 6, 330497, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 6, 330497, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 6, 330497, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 6, 330497, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4329180, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 6, 330497, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22437640, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 6, 330497, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.89, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 6, 330497, tzinfo=datetime.timezone.utc), 'load.1m', 0.13, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 6, 330497, tzinfo=datetime.timezone.utc), 'load.5m', 0.24, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 6, 330497, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:30:11,541 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 30, 11, 435370, tzinfo=datetime.timezone.utc), 'cpu.total', 4.8799999999999955, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 11, 435370, tzinfo=datetime.timezone.utc), 'cpu.user', 3.66, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 11, 435370, tzinfo=datetime.timezone.utc), 'cpu.system', 1.22, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 11, 435370, tzinfo=datetime.timezone.utc), 'cpu.idle', 95.12, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 11, 435370, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4333180, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 11, 435370, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22433624, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 11, 435370, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.88, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 11, 435370, tzinfo=datetime.timezone.utc), 'load.1m', 0.12, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 11, 435370, tzinfo=datetime.timezone.utc), 'load.5m', 0.24, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 11, 435370, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:30:16,649 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 30, 16, 545128, tzinfo=datetime.timezone.utc), 'cpu.total', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 16, 545128, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 16, 545128, tzinfo=datetime.timezone.utc), 'cpu.system', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 16, 545128, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 16, 545128, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4334888, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 16, 545128, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22431908, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 16, 545128, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.87, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 16, 545128, tzinfo=datetime.timezone.utc), 'load.1m', 0.11, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 16, 545128, tzinfo=datetime.timezone.utc), 'load.5m', 0.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 16, 545128, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:30:21,754 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 30, 21, 651657, tzinfo=datetime.timezone.utc), 'cpu.total', 6.170000000000002, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 21, 651657, tzinfo=datetime.timezone.utc), 'cpu.user', 3.7, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 21, 651657, tzinfo=datetime.timezone.utc), 'cpu.system', 2.47, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 21, 651657, tzinfo=datetime.timezone.utc), 'cpu.idle', 93.83, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 21, 651657, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4336380, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 21, 651657, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22430388, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 21, 651657, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.87, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 21, 651657, tzinfo=datetime.timezone.utc), 'load.1m', 0.1, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 21, 651657, tzinfo=datetime.timezone.utc), 'load.5m', 0.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 21, 651657, tzinfo=datetime.timezone.utc), 'load.15m', 0.19, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:30:26,859 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 30, 26, 755444, tzinfo=datetime.timezone.utc), 'cpu.total', 36.05, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 26, 755444, tzinfo=datetime.timezone.utc), 'cpu.user', 27.91, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 26, 755444, tzinfo=datetime.timezone.utc), 'cpu.system', 8.14, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 26, 755444, tzinfo=datetime.timezone.utc), 'cpu.idle', 63.95, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 26, 755444, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4336548, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 26, 755444, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22430200, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 26, 755444, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.87, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 26, 755444, tzinfo=datetime.timezone.utc), 'load.1m', 0.18, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 26, 755444, tzinfo=datetime.timezone.utc), 'load.5m', 0.24, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 26, 755444, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:30:31,968 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 30, 31, 864793, tzinfo=datetime.timezone.utc), 'cpu.total', 3.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 31, 864793, tzinfo=datetime.timezone.utc), 'cpu.user', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 31, 864793, tzinfo=datetime.timezone.utc), 'cpu.system', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 31, 864793, tzinfo=datetime.timezone.utc), 'cpu.idle', 96.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 31, 864793, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4379276, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 31, 864793, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22387400, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 31, 864793, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.72, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 31, 864793, tzinfo=datetime.timezone.utc), 'load.1m', 0.16, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 31, 864793, tzinfo=datetime.timezone.utc), 'load.5m', 0.24, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 31, 864793, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:30:37,076 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 30, 36, 972204, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 36, 972204, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 36, 972204, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 36, 972204, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 36, 972204, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4385588, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 36, 972204, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22381044, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 36, 972204, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.69, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 36, 972204, tzinfo=datetime.timezone.utc), 'load.1m', 0.15, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 36, 972204, tzinfo=datetime.timezone.utc), 'load.5m', 0.24, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 36, 972204, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:30:42,182 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 30, 42, 79152, tzinfo=datetime.timezone.utc), 'cpu.total', 7.409999999999997, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 42, 79152, tzinfo=datetime.timezone.utc), 'cpu.user', 1.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 42, 79152, tzinfo=datetime.timezone.utc), 'cpu.system', 6.17, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 42, 79152, tzinfo=datetime.timezone.utc), 'cpu.idle', 92.59, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 42, 79152, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4387040, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 42, 79152, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22379592, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 42, 79152, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.69, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 42, 79152, tzinfo=datetime.timezone.utc), 'load.1m', 0.22, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 42, 79152, tzinfo=datetime.timezone.utc), 'load.5m', 0.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 42, 79152, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:30:47,287 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 30, 47, 184363, tzinfo=datetime.timezone.utc), 'cpu.total', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 47, 184363, tzinfo=datetime.timezone.utc), 'cpu.user', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 47, 184363, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 47, 184363, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 47, 184363, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4330692, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 47, 184363, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22435928, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 47, 184363, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.89, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 47, 184363, tzinfo=datetime.timezone.utc), 'load.1m', 0.2, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 47, 184363, tzinfo=datetime.timezone.utc), 'load.5m', 0.24, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 47, 184363, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:30:53,743 [INFO] app.main - Initialising Ira API application
2025-12-20 16:30:53,743 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 16:30:53,744 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 16:30:53,750 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 16:30:53,891 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 30, 53, 750392, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 53, 750392, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 53, 750392, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 53, 750392, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 53, 750392, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4329656, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 53, 750392, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22436668, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 53, 750392, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.89, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 53, 750392, tzinfo=datetime.timezone.utc), 'load.1m', 0.26, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 53, 750392, tzinfo=datetime.timezone.utc), 'load.5m', 0.26, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 53, 750392, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:30:59,000 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 30, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 30, 58, 895366, tzinfo=datetime.timezone.utc), 'cpu.total', 1.230000000000004, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 58, 895366, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 58, 895366, tzinfo=datetime.timezone.utc), 'cpu.system', 1.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 58, 895366, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.77, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 58, 895366, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4332480, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 58, 895366, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22433844, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 58, 895366, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.88, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 58, 895366, tzinfo=datetime.timezone.utc), 'load.1m', 0.24, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 58, 895366, tzinfo=datetime.timezone.utc), 'load.5m', 0.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 30, 58, 895366, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:31:04,105 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 31, 4, 2377, tzinfo=datetime.timezone.utc), 'cpu.total', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 4, 2377, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 4, 2377, tzinfo=datetime.timezone.utc), 'cpu.system', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 4, 2377, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 4, 2377, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4334232, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 4, 2377, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22431604, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 4, 2377, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.87, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 4, 2377, tzinfo=datetime.timezone.utc), 'load.1m', 0.22, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 4, 2377, tzinfo=datetime.timezone.utc), 'load.5m', 0.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 4, 2377, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:31:09,210 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 31, 9, 107318, tzinfo=datetime.timezone.utc), 'cpu.total', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 9, 107318, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 9, 107318, tzinfo=datetime.timezone.utc), 'cpu.system', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 9, 107318, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 9, 107318, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4334088, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 9, 107318, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22431720, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 9, 107318, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.87, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 9, 107318, tzinfo=datetime.timezone.utc), 'load.1m', 0.2, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 9, 107318, tzinfo=datetime.timezone.utc), 'load.5m', 0.24, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 9, 107318, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:31:14,322 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 31, 14, 214269, tzinfo=datetime.timezone.utc), 'cpu.total', 2.4399999999999977, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 14, 214269, tzinfo=datetime.timezone.utc), 'cpu.user', 1.22, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 14, 214269, tzinfo=datetime.timezone.utc), 'cpu.system', 1.22, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 14, 214269, tzinfo=datetime.timezone.utc), 'cpu.idle', 97.56, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 14, 214269, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4337556, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 14, 214269, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22428232, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 14, 214269, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.86, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 14, 214269, tzinfo=datetime.timezone.utc), 'load.1m', 0.19, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 14, 214269, tzinfo=datetime.timezone.utc), 'load.5m', 0.24, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 14, 214269, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:31:19,430 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 31, 19, 325923, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 19, 325923, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 19, 325923, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 19, 325923, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 19, 325923, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4582692, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 19, 325923, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22182508, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 19, 325923, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.01, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 19, 325923, tzinfo=datetime.timezone.utc), 'load.1m', 0.17, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 19, 325923, tzinfo=datetime.timezone.utc), 'load.5m', 0.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 19, 325923, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:31:24,535 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 31, 24, 431954, tzinfo=datetime.timezone.utc), 'cpu.total', 2.5, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 24, 431954, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 24, 431954, tzinfo=datetime.timezone.utc), 'cpu.system', 2.5, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 24, 431954, tzinfo=datetime.timezone.utc), 'cpu.idle', 97.5, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 24, 431954, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4592232, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 24, 431954, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22172948, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 24, 431954, tzinfo=datetime.timezone.utc), 'memory.available_percent', 82.98, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 24, 431954, tzinfo=datetime.timezone.utc), 'load.1m', 0.16, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 24, 431954, tzinfo=datetime.timezone.utc), 'load.5m', 0.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 24, 431954, tzinfo=datetime.timezone.utc), 'load.15m', 0.19, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:31:29,641 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 31, 29, 538349, tzinfo=datetime.timezone.utc), 'cpu.total', 2.469999999999999, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 29, 538349, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 29, 538349, tzinfo=datetime.timezone.utc), 'cpu.system', 1.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 29, 538349, tzinfo=datetime.timezone.utc), 'cpu.idle', 97.53, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 29, 538349, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4596972, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 29, 538349, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22168176, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 29, 538349, tzinfo=datetime.timezone.utc), 'memory.available_percent', 82.96, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 29, 538349, tzinfo=datetime.timezone.utc), 'load.1m', 0.15, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 29, 538349, tzinfo=datetime.timezone.utc), 'load.5m', 0.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 29, 538349, tzinfo=datetime.timezone.utc), 'load.15m', 0.19, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:31:34,747 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 31, 34, 643474, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 34, 643474, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 34, 643474, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 34, 643474, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 34, 643474, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4485888, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 34, 643474, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22279060, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 34, 643474, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.35, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 34, 643474, tzinfo=datetime.timezone.utc), 'load.1m', 0.21, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 34, 643474, tzinfo=datetime.timezone.utc), 'load.5m', 0.24, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 34, 643474, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:31:39,852 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 31, 39, 749719, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 39, 749719, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 39, 749719, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 39, 749719, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 39, 749719, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4385168, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 39, 749719, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22379760, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 39, 749719, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.7, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 39, 749719, tzinfo=datetime.timezone.utc), 'load.1m', 0.2, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 39, 749719, tzinfo=datetime.timezone.utc), 'load.5m', 0.24, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 39, 749719, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:31:44,958 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 31, 44, 855350, tzinfo=datetime.timezone.utc), 'cpu.total', 1.2800000000000011, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 44, 855350, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 44, 855350, tzinfo=datetime.timezone.utc), 'cpu.system', 1.28, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 44, 855350, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.72, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 44, 855350, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4383468, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 44, 855350, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22381428, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 44, 855350, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.7, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 44, 855350, tzinfo=datetime.timezone.utc), 'load.1m', 0.18, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 44, 855350, tzinfo=datetime.timezone.utc), 'load.5m', 0.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 44, 855350, tzinfo=datetime.timezone.utc), 'load.15m', 0.19, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:31:45,780 [INFO] app.main - Initialising Ira API application
2025-12-20 16:31:45,780 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 16:31:45,780 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 16:31:45,785 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 16:31:45,925 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 31, 45, 785953, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 45, 785953, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 45, 785953, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 45, 785953, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 45, 785953, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4373764, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 45, 785953, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22391120, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 45, 785953, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.74, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 45, 785953, tzinfo=datetime.timezone.utc), 'load.1m', 0.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 45, 785953, tzinfo=datetime.timezone.utc), 'load.5m', 0.24, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 45, 785953, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:31:51,034 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 31, 50, 930878, tzinfo=datetime.timezone.utc), 'cpu.total', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 50, 930878, tzinfo=datetime.timezone.utc), 'cpu.user', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 50, 930878, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 50, 930878, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.75, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 50, 930878, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4381564, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 50, 930878, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22383300, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 50, 930878, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.71, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 50, 930878, tzinfo=datetime.timezone.utc), 'load.1m', 0.31, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 50, 930878, tzinfo=datetime.timezone.utc), 'load.5m', 0.26, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 50, 930878, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:31:56,139 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 31, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 31, 56, 34361, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 56, 34361, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 56, 34361, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 56, 34361, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 56, 34361, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4382896, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 56, 34361, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22381948, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 56, 34361, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.7, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 56, 34361, tzinfo=datetime.timezone.utc), 'load.1m', 0.28, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 56, 34361, tzinfo=datetime.timezone.utc), 'load.5m', 0.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 31, 56, 34361, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:32:01,246 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 32, 1, 142498, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 1, 142498, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 1, 142498, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 1, 142498, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 1, 142498, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4380620, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 1, 142498, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22384200, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 1, 142498, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.71, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 1, 142498, tzinfo=datetime.timezone.utc), 'load.1m', 0.26, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 1, 142498, tzinfo=datetime.timezone.utc), 'load.5m', 0.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 1, 142498, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:32:06,354 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 32, 6, 249370, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 6, 249370, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 6, 249370, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 6, 249370, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 6, 249370, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4383348, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 6, 249370, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22381420, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 6, 249370, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.7, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 6, 249370, tzinfo=datetime.timezone.utc), 'load.1m', 0.24, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 6, 249370, tzinfo=datetime.timezone.utc), 'load.5m', 0.24, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 6, 249370, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:32:11,459 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 32, 11, 356130, tzinfo=datetime.timezone.utc), 'cpu.total', 2.469999999999999, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 11, 356130, tzinfo=datetime.timezone.utc), 'cpu.user', 1.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 11, 356130, tzinfo=datetime.timezone.utc), 'cpu.system', 1.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 11, 356130, tzinfo=datetime.timezone.utc), 'cpu.idle', 97.53, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 11, 356130, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4383200, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 11, 356130, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22381548, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 11, 356130, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.7, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 11, 356130, tzinfo=datetime.timezone.utc), 'load.1m', 0.22, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 11, 356130, tzinfo=datetime.timezone.utc), 'load.5m', 0.24, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 11, 356130, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:32:16,564 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 32, 16, 461661, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 16, 461661, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 16, 461661, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 16, 461661, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 16, 461661, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4387164, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 16, 461661, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22377564, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 16, 461661, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.69, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 16, 461661, tzinfo=datetime.timezone.utc), 'load.1m', 0.2, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 16, 461661, tzinfo=datetime.timezone.utc), 'load.5m', 0.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 16, 461661, tzinfo=datetime.timezone.utc), 'load.15m', 0.2, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:32:21,670 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 32, 21, 567292, tzinfo=datetime.timezone.utc), 'cpu.total', 1.230000000000004, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 21, 567292, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 21, 567292, tzinfo=datetime.timezone.utc), 'cpu.system', 1.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 21, 567292, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.77, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 21, 567292, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4394824, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 21, 567292, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22369880, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 21, 567292, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.66, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 21, 567292, tzinfo=datetime.timezone.utc), 'load.1m', 0.18, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 21, 567292, tzinfo=datetime.timezone.utc), 'load.5m', 0.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 21, 567292, tzinfo=datetime.timezone.utc), 'load.15m', 0.19, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:32:26,774 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 32, 26, 671312, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 26, 671312, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 26, 671312, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 26, 671312, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 26, 671312, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4394204, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 26, 671312, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22370484, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 26, 671312, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.66, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 26, 671312, tzinfo=datetime.timezone.utc), 'load.1m', 0.17, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 26, 671312, tzinfo=datetime.timezone.utc), 'load.5m', 0.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 26, 671312, tzinfo=datetime.timezone.utc), 'load.15m', 0.19, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:32:31,880 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 32, 31, 776880, tzinfo=datetime.timezone.utc), 'cpu.total', 1.269999999999996, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 31, 776880, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 31, 776880, tzinfo=datetime.timezone.utc), 'cpu.system', 1.27, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 31, 776880, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.73, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 31, 776880, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4390344, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 31, 776880, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22374284, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 31, 776880, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.68, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 31, 776880, tzinfo=datetime.timezone.utc), 'load.1m', 0.16, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 31, 776880, tzinfo=datetime.timezone.utc), 'load.5m', 0.22, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 31, 776880, tzinfo=datetime.timezone.utc), 'load.15m', 0.19, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:32:36,986 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 32, 36, 883134, tzinfo=datetime.timezone.utc), 'cpu.total', 2.469999999999999, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 36, 883134, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 36, 883134, tzinfo=datetime.timezone.utc), 'cpu.system', 2.47, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 36, 883134, tzinfo=datetime.timezone.utc), 'cpu.idle', 97.53, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 36, 883134, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4389768, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 36, 883134, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22374816, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 36, 883134, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.68, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 36, 883134, tzinfo=datetime.timezone.utc), 'load.1m', 0.14, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 36, 883134, tzinfo=datetime.timezone.utc), 'load.5m', 0.22, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 36, 883134, tzinfo=datetime.timezone.utc), 'load.15m', 0.19, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:32:42,091 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 32, 41, 988586, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 41, 988586, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 41, 988586, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 41, 988586, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 41, 988586, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4388020, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 41, 988586, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22376564, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 41, 988586, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.69, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 41, 988586, tzinfo=datetime.timezone.utc), 'load.1m', 0.13, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 41, 988586, tzinfo=datetime.timezone.utc), 'load.5m', 0.22, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 41, 988586, tzinfo=datetime.timezone.utc), 'load.15m', 0.19, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:32:47,198 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 32, 47, 94609, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 47, 94609, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 47, 94609, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 47, 94609, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 47, 94609, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4387824, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 47, 94609, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22376760, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 47, 94609, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.69, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 47, 94609, tzinfo=datetime.timezone.utc), 'load.1m', 0.12, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 47, 94609, tzinfo=datetime.timezone.utc), 'load.5m', 0.21, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 47, 94609, tzinfo=datetime.timezone.utc), 'load.15m', 0.19, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:32:52,304 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 32, 52, 200594, tzinfo=datetime.timezone.utc), 'cpu.total', 1.230000000000004, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 52, 200594, tzinfo=datetime.timezone.utc), 'cpu.user', 1.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 52, 200594, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 52, 200594, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.77, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 52, 200594, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4385876, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 52, 200594, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22378692, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 52, 200594, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.69, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 52, 200594, tzinfo=datetime.timezone.utc), 'load.1m', 0.11, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 52, 200594, tzinfo=datetime.timezone.utc), 'load.5m', 0.21, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 52, 200594, tzinfo=datetime.timezone.utc), 'load.15m', 0.19, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:32:57,409 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 32, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 32, 57, 305692, tzinfo=datetime.timezone.utc), 'cpu.total', 2.5, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 57, 305692, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 57, 305692, tzinfo=datetime.timezone.utc), 'cpu.system', 1.25, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 57, 305692, tzinfo=datetime.timezone.utc), 'cpu.idle', 97.5, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 57, 305692, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4386752, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 57, 305692, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22377808, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 57, 305692, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.69, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 57, 305692, tzinfo=datetime.timezone.utc), 'load.1m', 0.1, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 57, 305692, tzinfo=datetime.timezone.utc), 'load.5m', 0.2, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 32, 57, 305692, tzinfo=datetime.timezone.utc), 'load.15m', 0.18, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:33:02,516 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 33, 2, 412017, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 2, 412017, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 2, 412017, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 2, 412017, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 2, 412017, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4403044, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 2, 412017, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22361496, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 2, 412017, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.63, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 2, 412017, tzinfo=datetime.timezone.utc), 'load.1m', 0.17, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 2, 412017, tzinfo=datetime.timezone.utc), 'load.5m', 0.22, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 2, 412017, tzinfo=datetime.timezone.utc), 'load.15m', 0.19, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:33:07,622 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 33, 7, 518658, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 7, 518658, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 7, 518658, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 7, 518658, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 7, 518658, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4408052, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 7, 518658, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22356120, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 7, 518658, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.62, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 7, 518658, tzinfo=datetime.timezone.utc), 'load.1m', 0.24, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 7, 518658, tzinfo=datetime.timezone.utc), 'load.5m', 0.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 7, 518658, tzinfo=datetime.timezone.utc), 'load.15m', 0.19, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:33:12,727 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 33, 12, 624157, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 12, 624157, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 12, 624157, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 12, 624157, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 12, 624157, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4413824, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 12, 624157, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22350336, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 12, 624157, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.6, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 12, 624157, tzinfo=datetime.timezone.utc), 'load.1m', 0.22, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 12, 624157, tzinfo=datetime.timezone.utc), 'load.5m', 0.23, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 12, 624157, tzinfo=datetime.timezone.utc), 'load.15m', 0.19, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:33:17,835 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 33, 17, 731418, tzinfo=datetime.timezone.utc), 'cpu.total', 7.890000000000001, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 17, 731418, tzinfo=datetime.timezone.utc), 'cpu.user', 3.95, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 17, 731418, tzinfo=datetime.timezone.utc), 'cpu.system', 3.95, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 17, 731418, tzinfo=datetime.timezone.utc), 'cpu.idle', 92.11, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 17, 731418, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4417400, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 17, 731418, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22346748, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 17, 731418, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.58, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 17, 731418, tzinfo=datetime.timezone.utc), 'load.1m', 0.2, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 17, 731418, tzinfo=datetime.timezone.utc), 'load.5m', 0.22, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 17, 731418, tzinfo=datetime.timezone.utc), 'load.15m', 0.19, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:33:22,940 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 33, 22, 837808, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 22, 837808, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 22, 837808, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 22, 837808, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 22, 837808, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4424980, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 22, 837808, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22339152, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 22, 837808, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.56, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 22, 837808, tzinfo=datetime.timezone.utc), 'load.1m', 0.19, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 22, 837808, tzinfo=datetime.timezone.utc), 'load.5m', 0.22, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 22, 837808, tzinfo=datetime.timezone.utc), 'load.15m', 0.19, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:33:28,044 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 33, 27, 941127, tzinfo=datetime.timezone.utc), 'cpu.total', 1.2800000000000011, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 27, 941127, tzinfo=datetime.timezone.utc), 'cpu.user', 1.28, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 27, 941127, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 27, 941127, tzinfo=datetime.timezone.utc), 'cpu.idle', 98.72, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 27, 941127, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4429160, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 27, 941127, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22334960, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 27, 941127, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.54, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 27, 941127, tzinfo=datetime.timezone.utc), 'load.1m', 0.17, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 27, 941127, tzinfo=datetime.timezone.utc), 'load.5m', 0.21, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 27, 941127, tzinfo=datetime.timezone.utc), 'load.15m', 0.19, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:33:33,152 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 33, 33, 47696, tzinfo=datetime.timezone.utc), 'cpu.total', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 33, 47696, tzinfo=datetime.timezone.utc), 'cpu.user', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 33, 47696, tzinfo=datetime.timezone.utc), 'cpu.system', 0.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 33, 47696, tzinfo=datetime.timezone.utc), 'cpu.idle', 100.0, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 33, 47696, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4430180, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 33, 47696, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22333936, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 33, 47696, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.54, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 33, 47696, tzinfo=datetime.timezone.utc), 'load.1m', 0.16, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 33, 47696, tzinfo=datetime.timezone.utc), 'load.5m', 0.21, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 33, 47696, tzinfo=datetime.timezone.utc), 'load.15m', 0.19, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:33:38,258 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics_service.py", line 130, in collect_metrics
    await self._repo.bulk_insert(entities)
  File "/home/markus/projects/IRANet/ira/app/repositories/metric_point.py", line 43, in bulk_insert
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2133, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2125, in _exec_insertmany_context
    dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: datetime.datetime(2025, 12, 20, 16, 33, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO metrics_points (ts, metric, value, host) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::FLOAT, p3::VARCHAR FROM (VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::FLOAT, $4::VARCHAR, 0), ($5::TIMESTAMP WITHOUT TIME ZONE, ... 689 characters truncated ... 1, p2, p3, sen_counter) ORDER BY sen_counter RETURNING metrics_points.id, metrics_points.id AS id__1]
[parameters: (datetime.datetime(2025, 12, 20, 16, 33, 38, 154435, tzinfo=datetime.timezone.utc), 'cpu.total', 40.24, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 38, 154435, tzinfo=datetime.timezone.utc), 'cpu.user', 37.8, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 38, 154435, tzinfo=datetime.timezone.utc), 'cpu.system', 2.44, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 38, 154435, tzinfo=datetime.timezone.utc), 'cpu.idle', 59.76, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 38, 154435, tzinfo=datetime.timezone.utc), 'memory.used_kb', 4429056, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 38, 154435, tzinfo=datetime.timezone.utc), 'memory.free_kb', 22334964, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 38, 154435, tzinfo=datetime.timezone.utc), 'memory.available_percent', 83.54, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 38, 154435, tzinfo=datetime.timezone.utc), 'load.1m', 0.14, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 38, 154435, tzinfo=datetime.timezone.utc), 'load.5m', 0.21, 'DESKTOP-B5V272O', datetime.datetime(2025, 12, 20, 16, 33, 38, 154435, tzinfo=datetime.timezone.utc), 'load.15m', 0.18, 'DESKTOP-B5V272O')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 16:33:48,979 [INFO] app.main - Initialising Ira API application
2025-12-20 16:33:48,979 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 16:33:48,980 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 16:33:48,984 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 16:33:51,200 [INFO] app.main - Initialising Ira API application
2025-12-20 16:33:51,200 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 16:33:51,201 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 16:33:51,205 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 16:58:37,801 [INFO] app.main - Initialising Ira API application
2025-12-20 16:58:37,801 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 16:58:37,802 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 16:58:37,809 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 16:58:48,417 [INFO] app.main - Initialising Ira API application
2025-12-20 16:58:48,418 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 16:58:48,418 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 16:58:48,424 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 16:58:54,417 [INFO] app.main - Initialising Ira API application
2025-12-20 16:58:54,417 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 16:58:54,417 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 16:58:54,423 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 16:59:23,013 [INFO] app.main - Initialising Ira API application
2025-12-20 16:59:23,015 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 16:59:23,015 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 16:59:23,021 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 16:59:25,418 [INFO] app.main - Initialising Ira API application
2025-12-20 16:59:25,418 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 16:59:25,418 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 16:59:25,423 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:34:33,806 [INFO] app.main - Initialising Ira API application
2025-12-20 22:34:33,806 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:34:33,807 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:34:33,816 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:34:38,267 [INFO] app.main - Initialising Ira API application
2025-12-20 22:34:38,268 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:34:38,268 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:34:38,277 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:34:42,610 [INFO] app.main - Initialising Ira API application
2025-12-20 22:34:42,611 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:34:42,611 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:34:42,617 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:34:46,981 [INFO] app.main - Initialising Ira API application
2025-12-20 22:34:46,982 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:34:46,982 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:34:46,987 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:34:47,134 [ERROR] app.services.system_alerts_service - Failed to persist alert memory.available.percent for DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 34, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 34, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/services/system_alerts_service.py", line 84, in _save_critical_alert
    await self.alerts_repository.insert_critical(
  File "/home/markus/projects/IRANet/ira/app/repositories/system_alerts.py", line 62, in insert_critical
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 34, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO system_alerts (id, host, metric, level, value, threshold, status, message, first_seen_at, last_seen_at, resolved_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::FLOAT, $7::VARCHAR, $8::VARCHAR, $9::TIMESTAMP WITHOUT TIME ZONE, $10::TIMESTAMP WITHOUT TIME ZONE, $11::TIMESTAMP WITHOUT TIME ZONE)]
[parameters: (UUID('cf4591ac-7e54-4e6a-bcf3-75910f03ae17'), 'DESKTOP-B5V272O', 'memory.available.percent', 'critical', 79.78, 80, 'active', 'Low available memory: 79.78%', datetime.datetime(2025, 12, 20, 22, 34, 47, 129880, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 12, 20, 22, 34, 47, 129880, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 22:34:47,140 [INFO] app.services.system_alerts_service - Broadcasted critical alert memory.available.percent for DESKTOP-B5V272O: Low available memory: 79.78%
2025-12-20 22:34:52,250 [ERROR] app.services.system_alerts_service - Failed to persist alert memory.available.percent for DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 34, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 34, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/services/system_alerts_service.py", line 84, in _save_critical_alert
    await self.alerts_repository.insert_critical(
  File "/home/markus/projects/IRANet/ira/app/repositories/system_alerts.py", line 62, in insert_critical
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 34, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO system_alerts (id, host, metric, level, value, threshold, status, message, first_seen_at, last_seen_at, resolved_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::FLOAT, $7::VARCHAR, $8::VARCHAR, $9::TIMESTAMP WITHOUT TIME ZONE, $10::TIMESTAMP WITHOUT TIME ZONE, $11::TIMESTAMP WITHOUT TIME ZONE)]
[parameters: (UUID('e3a08343-ce7f-458d-a7f5-472ca1f0c77a'), 'DESKTOP-B5V272O', 'memory.available.percent', 'critical', 79.34, 80, 'active', 'Low available memory: 79.34%', datetime.datetime(2025, 12, 20, 22, 34, 52, 247628, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 12, 20, 22, 34, 52, 247628, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 22:34:52,253 [INFO] app.services.system_alerts_service - Broadcasted critical alert memory.available.percent for DESKTOP-B5V272O: Low available memory: 79.34%
2025-12-20 22:34:55,798 [INFO] app.main - Initialising Ira API application
2025-12-20 22:34:55,799 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:34:55,799 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:34:55,804 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:34:55,946 [ERROR] app.services.system_alerts_service - Failed to persist alert memory.available.percent for DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 34, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 34, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/services/system_alerts_service.py", line 84, in _save_critical_alert
    await self.alerts_repository.insert_critical(
  File "/home/markus/projects/IRANet/ira/app/repositories/system_alerts.py", line 62, in insert_critical
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 34, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO system_alerts (id, host, metric, level, value, threshold, status, message, first_seen_at, last_seen_at, resolved_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::FLOAT, $7::VARCHAR, $8::VARCHAR, $9::TIMESTAMP WITHOUT TIME ZONE, $10::TIMESTAMP WITHOUT TIME ZONE, $11::TIMESTAMP WITHOUT TIME ZONE)]
[parameters: (UUID('f290d623-af96-4ae2-bc0c-170f2b5de79e'), 'DESKTOP-B5V272O', 'memory.available.percent', 'critical', 79.31, 80, 'active', 'Low available memory: 79.31%', datetime.datetime(2025, 12, 20, 22, 34, 55, 942986, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 12, 20, 22, 34, 55, 942986, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 22:34:55,950 [INFO] app.services.system_alerts_service - Broadcasted critical alert memory.available.percent for DESKTOP-B5V272O: Low available memory: 79.31%
2025-12-20 22:35:00,341 [INFO] app.main - Initialising Ira API application
2025-12-20 22:35:00,341 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:35:00,342 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:35:00,347 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:35:00,493 [ERROR] app.services.system_alerts_service - Failed to persist alert memory.available.percent for DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 35, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 35, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/services/system_alerts_service.py", line 84, in _save_critical_alert
    await self.alerts_repository.insert_critical(
  File "/home/markus/projects/IRANet/ira/app/repositories/system_alerts.py", line 62, in insert_critical
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 35, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO system_alerts (id, host, metric, level, value, threshold, status, message, first_seen_at, last_seen_at, resolved_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::FLOAT, $7::VARCHAR, $8::VARCHAR, $9::TIMESTAMP WITHOUT TIME ZONE, $10::TIMESTAMP WITHOUT TIME ZONE, $11::TIMESTAMP WITHOUT TIME ZONE)]
[parameters: (UUID('7dd74f77-0be8-4199-bf88-3bdc558521cf'), 'DESKTOP-B5V272O', 'memory.available.percent', 'critical', 79.25, 80, 'active', 'Low available memory: 79.25%', datetime.datetime(2025, 12, 20, 22, 35, 0, 490451, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 12, 20, 22, 35, 0, 490451, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 22:35:00,497 [INFO] app.services.system_alerts_service - Broadcasted critical alert memory.available.percent for DESKTOP-B5V272O: Low available memory: 79.25%
2025-12-20 22:35:05,607 [ERROR] app.services.system_alerts_service - Failed to persist alert memory.available.percent for DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 35, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 35, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/services/system_alerts_service.py", line 84, in _save_critical_alert
    await self.alerts_repository.insert_critical(
  File "/home/markus/projects/IRANet/ira/app/repositories/system_alerts.py", line 62, in insert_critical
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 35, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO system_alerts (id, host, metric, level, value, threshold, status, message, first_seen_at, last_seen_at, resolved_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::FLOAT, $7::VARCHAR, $8::VARCHAR, $9::TIMESTAMP WITHOUT TIME ZONE, $10::TIMESTAMP WITHOUT TIME ZONE, $11::TIMESTAMP WITHOUT TIME ZONE)]
[parameters: (UUID('38adb58c-db45-4622-9315-452f544143cd'), 'DESKTOP-B5V272O', 'memory.available.percent', 'critical', 79.23, 80, 'active', 'Low available memory: 79.23%', datetime.datetime(2025, 12, 20, 22, 35, 5, 605385, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 12, 20, 22, 35, 5, 605385, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 22:35:05,610 [INFO] app.services.system_alerts_service - Broadcasted critical alert memory.available.percent for DESKTOP-B5V272O: Low available memory: 79.23%
2025-12-20 22:35:19,013 [INFO] app.main - Initialising Ira API application
2025-12-20 22:35:19,014 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:35:19,014 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:35:19,019 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:36:16,618 [INFO] app.main - Initialising Ira API application
2025-12-20 22:36:16,618 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:36:16,618 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:36:16,624 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:38:26,280 [INFO] app.main - Initialising Ira API application
2025-12-20 22:38:26,280 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:38:26,280 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:38:26,286 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:38:28,275 [INFO] app.main - Initialising Ira API application
2025-12-20 22:38:28,275 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:38:28,276 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:38:28,281 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:38:37,110 [INFO] app.main - Initialising Ira API application
2025-12-20 22:38:37,110 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:38:37,110 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:38:37,115 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:38:56,712 [INFO] app.main - Initialising Ira API application
2025-12-20 22:38:56,712 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:38:56,712 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:38:56,717 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:39:02,015 [INFO] app.main - Initialising Ira API application
2025-12-20 22:39:02,016 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:39:02,016 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:39:02,024 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:39:03,895 [INFO] app.main - Initialising Ira API application
2025-12-20 22:39:03,896 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:39:03,896 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:39:03,901 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:39:07,015 [INFO] app.main - Initialising Ira API application
2025-12-20 22:39:07,015 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:39:07,015 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:39:07,020 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:42:52,361 [INFO] app.main - Initialising Ira API application
2025-12-20 22:42:52,362 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:42:52,362 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:42:52,368 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:42:54,977 [INFO] app.main - Initialising Ira API application
2025-12-20 22:42:54,977 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:42:54,978 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:42:54,984 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:42:55,967 [INFO] app.main - Initialising Ira API application
2025-12-20 22:42:55,967 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:42:55,968 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:42:55,974 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:43:09,918 [INFO] app.main - Initialising Ira API application
2025-12-20 22:43:09,919 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:43:09,920 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:43:09,926 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:43:10,668 [INFO] app.main - Initialising Ira API application
2025-12-20 22:43:10,669 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:43:10,669 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:43:10,674 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:43:10,824 [ERROR] app.services.system_alerts_service - Failed to persist alert memory.available.percent for DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 43, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 43, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/services/system_alerts_service.py", line 84, in _save_critical_alert
    await self.alerts_repository.insert_critical(
  File "/home/markus/projects/IRANet/ira/app/repositories/system_alerts.py", line 62, in insert_critical
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 43, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO system_alerts (id, host, metric, level, value, threshold, status, message, first_seen_at, last_seen_at, resolved_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::FLOAT, $7::VARCHAR, $8::VARCHAR, $9::TIMESTAMP WITHOUT TIME ZONE, $10::TIMESTAMP WITHOUT TIME ZONE, $11::TIMESTAMP WITHOUT TIME ZONE)]
[parameters: (UUID('edc163df-99d7-4802-903d-c330969715cb'), 'DESKTOP-B5V272O', 'memory.available.percent', 'critical', 79.54, 80, 'active', 'Low available memory: 79.54%', datetime.datetime(2025, 12, 20, 22, 43, 10, 820238, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 12, 20, 22, 43, 10, 820238, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 22:43:10,829 [INFO] app.services.system_alerts_service - Broadcasted critical alert memory.available.percent for DESKTOP-B5V272O: Low available memory: 79.54%
2025-12-20 22:43:15,938 [ERROR] app.services.system_alerts_service - Failed to persist alert memory.available.percent for DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 43, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 43, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/services/system_alerts_service.py", line 84, in _save_critical_alert
    await self.alerts_repository.insert_critical(
  File "/home/markus/projects/IRANet/ira/app/repositories/system_alerts.py", line 62, in insert_critical
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 43, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO system_alerts (id, host, metric, level, value, threshold, status, message, first_seen_at, last_seen_at, resolved_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::FLOAT, $7::VARCHAR, $8::VARCHAR, $9::TIMESTAMP WITHOUT TIME ZONE, $10::TIMESTAMP WITHOUT TIME ZONE, $11::TIMESTAMP WITHOUT TIME ZONE)]
[parameters: (UUID('53fd196a-11ed-49c6-9c7a-eb84686478b7'), 'DESKTOP-B5V272O', 'memory.available.percent', 'critical', 79.49, 80, 'active', 'Low available memory: 79.49%', datetime.datetime(2025, 12, 20, 22, 43, 15, 936121, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 12, 20, 22, 43, 15, 936121, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 22:43:15,941 [INFO] app.services.system_alerts_service - Broadcasted critical alert memory.available.percent for DESKTOP-B5V272O: Low available memory: 79.49%
2025-12-20 22:43:21,047 [ERROR] app.services.system_alerts_service - Failed to persist alert memory.available.percent for DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 43, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 43, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/services/system_alerts_service.py", line 84, in _save_critical_alert
    await self.alerts_repository.insert_critical(
  File "/home/markus/projects/IRANet/ira/app/repositories/system_alerts.py", line 62, in insert_critical
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 43, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO system_alerts (id, host, metric, level, value, threshold, status, message, first_seen_at, last_seen_at, resolved_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::FLOAT, $7::VARCHAR, $8::VARCHAR, $9::TIMESTAMP WITHOUT TIME ZONE, $10::TIMESTAMP WITHOUT TIME ZONE, $11::TIMESTAMP WITHOUT TIME ZONE)]
[parameters: (UUID('9fed86d7-c6df-4ad3-be2b-b854f2decb17'), 'DESKTOP-B5V272O', 'memory.available.percent', 'critical', 79.47, 80, 'active', 'Low available memory: 79.47%', datetime.datetime(2025, 12, 20, 22, 43, 21, 46486, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 12, 20, 22, 43, 21, 46486, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 22:43:21,049 [INFO] app.services.system_alerts_service - Broadcasted critical alert memory.available.percent for DESKTOP-B5V272O: Low available memory: 79.47%
2025-12-20 22:43:26,155 [ERROR] app.services.system_alerts_service - Failed to persist alert memory.available.percent for DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 43, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 43, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/services/system_alerts_service.py", line 84, in _save_critical_alert
    await self.alerts_repository.insert_critical(
  File "/home/markus/projects/IRANet/ira/app/repositories/system_alerts.py", line 62, in insert_critical
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 43, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO system_alerts (id, host, metric, level, value, threshold, status, message, first_seen_at, last_seen_at, resolved_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::FLOAT, $7::VARCHAR, $8::VARCHAR, $9::TIMESTAMP WITHOUT TIME ZONE, $10::TIMESTAMP WITHOUT TIME ZONE, $11::TIMESTAMP WITHOUT TIME ZONE)]
[parameters: (UUID('4c7f0cd0-a538-4fa7-a161-40e18c6f3a0f'), 'DESKTOP-B5V272O', 'memory.available.percent', 'critical', 79.45, 80, 'active', 'Low available memory: 79.45%', datetime.datetime(2025, 12, 20, 22, 43, 26, 153758, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 12, 20, 22, 43, 26, 153758, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 22:43:26,157 [INFO] app.services.system_alerts_service - Broadcasted critical alert memory.available.percent for DESKTOP-B5V272O: Low available memory: 79.45%
2025-12-20 22:43:31,266 [ERROR] app.services.system_alerts_service - Failed to persist alert memory.available.percent for DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 43, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 43, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/services/system_alerts_service.py", line 84, in _save_critical_alert
    await self.alerts_repository.insert_critical(
  File "/home/markus/projects/IRANet/ira/app/repositories/system_alerts.py", line 62, in insert_critical
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 43, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO system_alerts (id, host, metric, level, value, threshold, status, message, first_seen_at, last_seen_at, resolved_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::FLOAT, $7::VARCHAR, $8::VARCHAR, $9::TIMESTAMP WITHOUT TIME ZONE, $10::TIMESTAMP WITHOUT TIME ZONE, $11::TIMESTAMP WITHOUT TIME ZONE)]
[parameters: (UUID('3a4a1481-be98-4c20-9ac2-d6e4a307a9fb'), 'DESKTOP-B5V272O', 'memory.available.percent', 'critical', 79.36, 80, 'active', 'Low available memory: 79.36%', datetime.datetime(2025, 12, 20, 22, 43, 31, 264002, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 12, 20, 22, 43, 31, 264002, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 22:43:31,268 [INFO] app.services.system_alerts_service - Broadcasted critical alert memory.available.percent for DESKTOP-B5V272O: Low available memory: 79.36%
2025-12-20 22:43:52,946 [INFO] app.main - Initialising Ira API application
2025-12-20 22:43:52,946 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:43:52,946 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:43:52,951 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:43:54,174 [INFO] app.main - Initialising Ira API application
2025-12-20 22:43:54,175 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:43:54,175 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:43:54,181 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:45:13,561 [INFO] app.main - Initialising Ira API application
2025-12-20 22:45:13,561 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:45:13,562 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:45:13,567 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:45:21,071 [INFO] app.main - Initialising Ira API application
2025-12-20 22:45:21,071 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:45:21,071 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:45:21,076 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:45:25,242 [INFO] app.main - Initialising Ira API application
2025-12-20 22:45:25,242 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:45:25,242 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:45:25,248 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:45:34,506 [INFO] app.main - Initialising Ira API application
2025-12-20 22:45:34,507 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:45:34,507 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:45:34,512 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:45:49,964 [INFO] app.main - Initialising Ira API application
2025-12-20 22:45:49,965 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:45:49,965 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:45:49,972 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:45:50,947 [INFO] app.main - Initialising Ira API application
2025-12-20 22:45:50,947 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:45:50,948 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:45:50,953 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:45:54,962 [INFO] app.main - Initialising Ira API application
2025-12-20 22:45:54,962 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:45:54,963 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:45:54,969 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:45:55,938 [INFO] app.main - Initialising Ira API application
2025-12-20 22:45:55,938 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:45:55,938 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:45:55,946 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:45:59,636 [INFO] app.main - Initialising Ira API application
2025-12-20 22:45:59,636 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:45:59,637 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:45:59,641 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:46:02,518 [INFO] app.main - Initialising Ira API application
2025-12-20 22:46:02,519 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:46:02,519 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:46:02,525 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:48:09,587 [INFO] app.main - Initialising Ira API application
2025-12-20 22:48:09,587 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:48:09,587 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:48:09,592 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:48:12,061 [INFO] app.main - Initialising Ira API application
2025-12-20 22:48:12,062 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:48:12,062 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:48:12,066 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:48:12,742 [INFO] app.main - Initialising Ira API application
2025-12-20 22:48:12,742 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:48:12,743 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:48:12,748 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:48:36,753 [INFO] app.main - Initialising Ira API application
2025-12-20 22:48:36,753 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:48:36,753 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:48:36,760 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:48:39,019 [INFO] app.main - Initialising Ira API application
2025-12-20 22:48:39,019 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:48:39,020 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:48:39,025 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:48:40,458 [INFO] app.main - Initialising Ira API application
2025-12-20 22:48:40,459 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:48:40,459 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:48:40,464 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:48:46,482 [INFO] app.main - Initialising Ira API application
2025-12-20 22:48:46,482 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:48:46,482 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:48:46,490 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:49:59,097 [INFO] app.main - Initialising Ira API application
2025-12-20 22:49:59,098 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:49:59,098 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:49:59,103 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:49:59,205 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 119, in collect_metrics
    rows.extend()
TypeError: list.extend() takes exactly one argument (0 given)
2025-12-20 22:50:04,307 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 119, in collect_metrics
    rows.extend()
TypeError: list.extend() takes exactly one argument (0 given)
2025-12-20 22:50:09,409 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 119, in collect_metrics
    rows.extend()
TypeError: list.extend() takes exactly one argument (0 given)
2025-12-20 22:50:13,457 [INFO] app.main - Initialising Ira API application
2025-12-20 22:50:13,457 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:50:13,457 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:50:13,462 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:50:13,563 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 119, in collect_metrics
    rows.extend()
TypeError: list.extend() takes exactly one argument (0 given)
2025-12-20 22:50:15,710 [INFO] app.main - Initialising Ira API application
2025-12-20 22:50:15,710 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:50:15,710 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:50:15,715 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:50:15,816 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 119, in collect_metrics
    rows.extend()
TypeError: list.extend() takes exactly one argument (0 given)
2025-12-20 22:50:20,476 [INFO] app.main - Initialising Ira API application
2025-12-20 22:50:20,477 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:50:20,477 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:50:20,482 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:50:20,583 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 119, in collect_metrics
    rows.extend(build_internet_metrics)
                ^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'build_internet_metrics' is not defined
2025-12-20 22:50:21,740 [INFO] app.main - Initialising Ira API application
2025-12-20 22:50:21,740 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:50:21,741 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:50:21,747 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:50:21,849 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 119, in collect_metrics
    rows.extend(build_internet_metrics())
                ^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'build_internet_metrics' is not defined
2025-12-20 22:50:26,952 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 119, in collect_metrics
    rows.extend(build_internet_metrics())
                ^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'build_internet_metrics' is not defined
2025-12-20 22:50:32,055 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 119, in collect_metrics
    rows.extend(build_internet_metrics())
                ^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'build_internet_metrics' is not defined
2025-12-20 22:50:37,158 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 119, in collect_metrics
    rows.extend(build_internet_metrics())
                ^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'build_internet_metrics' is not defined
2025-12-20 22:50:38,843 [INFO] app.main - Initialising Ira API application
2025-12-20 22:50:38,844 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:50:38,844 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:50:38,849 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:50:38,850 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 30, in metrics_scheduler
    metrics_service = SystemMetricsService(session)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 18, in __init__
    self.internet_metrics_service = InternetMetricsService()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.__init__() missing 1 required keyword-only argument: 'ping_host'
2025-12-20 22:50:43,851 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 30, in metrics_scheduler
    metrics_service = SystemMetricsService(session)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 18, in __init__
    self.internet_metrics_service = InternetMetricsService()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.__init__() missing 1 required keyword-only argument: 'ping_host'
2025-12-20 22:50:48,852 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 30, in metrics_scheduler
    metrics_service = SystemMetricsService(session)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 18, in __init__
    self.internet_metrics_service = InternetMetricsService()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.__init__() missing 1 required keyword-only argument: 'ping_host'
2025-12-20 22:50:59,077 [INFO] app.main - Initialising Ira API application
2025-12-20 22:50:59,077 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:50:59,077 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:50:59,086 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:50:59,086 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 30, in metrics_scheduler
    metrics_service = SystemMetricsService(session)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 18, in __init__
    self.internet_metrics_service = InternetMetricsService()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/internet_metrics_service.py", line 11, in __init__
    self._ping_host = ping_host
                      ^^^^^^^^^
NameError: name 'ping_host' is not defined
2025-12-20 22:51:04,089 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 30, in metrics_scheduler
    metrics_service = SystemMetricsService(session)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 18, in __init__
    self.internet_metrics_service = InternetMetricsService()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/internet_metrics_service.py", line 11, in __init__
    self._ping_host = ping_host
                      ^^^^^^^^^
NameError: name 'ping_host' is not defined
2025-12-20 22:51:11,378 [INFO] app.main - Initialising Ira API application
2025-12-20 22:51:11,378 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:51:11,378 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:51:11,384 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:51:11,485 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 120, in collect_metrics
    rows.extend(build_internet_metrics())
                ^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'build_internet_metrics' is not defined
2025-12-20 22:51:16,589 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 120, in collect_metrics
    rows.extend(build_internet_metrics())
                ^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'build_internet_metrics' is not defined
2025-12-20 22:51:21,692 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 120, in collect_metrics
    rows.extend(build_internet_metrics())
                ^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'build_internet_metrics' is not defined
2025-12-20 22:51:26,723 [INFO] app.main - Initialising Ira API application
2025-12-20 22:51:26,723 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:51:26,724 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:51:26,729 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:51:26,830 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 120, in collect_metrics
    rows.extend(self.build_internet_metrics())
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'SystemMetricsService' object has no attribute 'build_internet_metrics'
2025-12-20 22:51:28,516 [INFO] app.main - Initialising Ira API application
2025-12-20 22:51:28,517 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:51:28,517 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:51:28,522 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:51:28,624 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 120, in collect_metrics
    rows.extend(self.internet_metrics_service.build_internet_metrics())
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.build_internet_metrics() missing 3 required keyword-only arguments: 'ts', 'host', and 'ping_host'
2025-12-20 22:51:33,725 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 120, in collect_metrics
    rows.extend(self.internet_metrics_service.build_internet_metrics())
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.build_internet_metrics() missing 3 required keyword-only arguments: 'ts', 'host', and 'ping_host'
2025-12-20 22:51:38,610 [INFO] app.main - Initialising Ira API application
2025-12-20 22:51:38,610 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:51:38,610 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:51:38,616 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:51:38,717 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 120, in collect_metrics
    rows.extend(self.internet_metrics_service.build_internet_metrics(ts, host))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.build_internet_metrics() takes 1 positional argument but 3 were given
2025-12-20 22:51:43,819 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 120, in collect_metrics
    rows.extend(self.internet_metrics_service.build_internet_metrics(ts, host))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.build_internet_metrics() takes 1 positional argument but 3 were given
2025-12-20 22:51:47,659 [INFO] app.main - Initialising Ira API application
2025-12-20 22:51:47,659 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:51:47,659 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:51:47,664 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:51:47,766 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 120, in collect_metrics
    rows.extend(self.internet_metrics_service.build_internet_metrics(ts, host, "1.1.1.1"))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.build_internet_metrics() takes 1 positional argument but 4 were given
2025-12-20 22:51:53,421 [INFO] app.main - Initialising Ira API application
2025-12-20 22:51:53,421 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:51:53,422 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:51:53,427 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:51:53,528 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 120, in collect_metrics
    rows.extend(self.internet_metrics_service.build_internet_metrics(ts, host, "1.1.1.1"))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.build_internet_metrics() takes 1 positional argument but 4 were given
2025-12-20 22:51:58,630 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 120, in collect_metrics
    rows.extend(self.internet_metrics_service.build_internet_metrics(ts, host, "1.1.1.1"))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.build_internet_metrics() takes 1 positional argument but 4 were given
2025-12-20 22:52:03,731 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 120, in collect_metrics
    rows.extend(self.internet_metrics_service.build_internet_metrics(ts, host, "1.1.1.1"))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.build_internet_metrics() takes 1 positional argument but 4 were given
2025-12-20 22:52:08,832 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 120, in collect_metrics
    rows.extend(self.internet_metrics_service.build_internet_metrics(ts, host, "1.1.1.1"))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.build_internet_metrics() takes 1 positional argument but 4 were given
2025-12-20 22:52:13,934 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 120, in collect_metrics
    rows.extend(self.internet_metrics_service.build_internet_metrics(ts, host, "1.1.1.1"))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.build_internet_metrics() takes 1 positional argument but 4 were given
2025-12-20 22:52:19,035 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 120, in collect_metrics
    rows.extend(self.internet_metrics_service.build_internet_metrics(ts, host, "1.1.1.1"))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.build_internet_metrics() takes 1 positional argument but 4 were given
2025-12-20 22:52:24,135 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 120, in collect_metrics
    rows.extend(self.internet_metrics_service.build_internet_metrics(ts, host, "1.1.1.1"))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.build_internet_metrics() takes 1 positional argument but 4 were given
2025-12-20 22:52:29,236 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 120, in collect_metrics
    rows.extend(self.internet_metrics_service.build_internet_metrics(ts, host, "1.1.1.1"))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.build_internet_metrics() takes 1 positional argument but 4 were given
2025-12-20 22:52:34,337 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 120, in collect_metrics
    rows.extend(self.internet_metrics_service.build_internet_metrics(ts, host, "1.1.1.1"))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.build_internet_metrics() takes 1 positional argument but 4 were given
2025-12-20 22:52:39,439 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 120, in collect_metrics
    rows.extend(self.internet_metrics_service.build_internet_metrics(ts, host, "1.1.1.1"))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.build_internet_metrics() takes 1 positional argument but 4 were given
2025-12-20 22:52:44,541 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 120, in collect_metrics
    rows.extend(self.internet_metrics_service.build_internet_metrics(ts, host, "1.1.1.1"))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.build_internet_metrics() takes 1 positional argument but 4 were given
2025-12-20 22:52:49,643 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 32, in metrics_scheduler
    points = await metrics_service.collect_metrics(host=host)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 120, in collect_metrics
    rows.extend(self.internet_metrics_service.build_internet_metrics(ts, host, "1.1.1.1"))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.build_internet_metrics() takes 1 positional argument but 4 were given
2025-12-20 22:52:53,723 [INFO] app.main - Initialising Ira API application
2025-12-20 22:52:53,724 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:52:53,724 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:52:53,730 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:52:53,730 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 30, in metrics_scheduler
    metrics_service = SystemMetricsService(session)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 18, in __init__
    self.internet_metrics_service = InternetMetricsService()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/internet_metrics_service.py", line 11, in __init__
    self._ping_host = ping_host
                      ^^^^^^^^^
NameError: name 'ping_host' is not defined
2025-12-20 22:52:54,697 [INFO] app.main - Initialising Ira API application
2025-12-20 22:52:54,698 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:52:54,698 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:52:54,703 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:52:54,703 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 30, in metrics_scheduler
    metrics_service = SystemMetricsService(session)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 18, in __init__
    self.internet_metrics_service = InternetMetricsService()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.__init__() missing 1 required keyword-only argument: 'ping_host'
2025-12-20 22:52:59,704 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 30, in metrics_scheduler
    metrics_service = SystemMetricsService(session)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 18, in __init__
    self.internet_metrics_service = InternetMetricsService()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.__init__() missing 1 required keyword-only argument: 'ping_host'
2025-12-20 22:53:02,247 [INFO] app.main - Initialising Ira API application
2025-12-20 22:53:02,247 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:53:02,247 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:53:02,254 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:53:02,255 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 30, in metrics_scheduler
    metrics_service = SystemMetricsService(session)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 18, in __init__
    self.internet_metrics_service = InternetMetricsService()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.__init__() missing 1 required keyword-only argument: 'ping_host'
2025-12-20 22:53:05,537 [INFO] app.main - Initialising Ira API application
2025-12-20 22:53:05,537 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:53:05,537 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:53:05,542 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:53:05,543 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 30, in metrics_scheduler
    metrics_service = SystemMetricsService(session)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 18, in __init__
    self.internet_metrics_service = InternetMetricsService()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.__init__() missing 1 required keyword-only argument: 'ping_host'
2025-12-20 22:53:10,544 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 30, in metrics_scheduler
    metrics_service = SystemMetricsService(session)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 18, in __init__
    self.internet_metrics_service = InternetMetricsService()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.__init__() missing 1 required keyword-only argument: 'ping_host'
2025-12-20 22:53:15,424 [INFO] app.main - Initialising Ira API application
2025-12-20 22:53:15,424 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:53:15,424 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:53:15,429 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:53:15,429 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 30, in metrics_scheduler
    metrics_service = SystemMetricsService(session)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 18, in __init__
    self.internet_metrics_service = InternetMetricsService()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.__init__() missing 1 required keyword-only argument: 'ping_host'
2025-12-20 22:53:20,430 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 30, in metrics_scheduler
    metrics_service = SystemMetricsService(session)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 18, in __init__
    self.internet_metrics_service = InternetMetricsService()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.__init__() missing 1 required keyword-only argument: 'ping_host'
2025-12-20 22:53:25,432 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 30, in metrics_scheduler
    metrics_service = SystemMetricsService(session)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 18, in __init__
    self.internet_metrics_service = InternetMetricsService()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.__init__() missing 1 required keyword-only argument: 'ping_host'
2025-12-20 22:53:27,114 [INFO] app.main - Initialising Ira API application
2025-12-20 22:53:27,114 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:53:27,114 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:53:27,119 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:53:27,120 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 30, in metrics_scheduler
    metrics_service = SystemMetricsService(session)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 18, in __init__
    self.internet_metrics_service = InternetMetricsService()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.__init__() missing 1 required keyword-only argument: 'ping_host'
2025-12-20 22:53:30,882 [INFO] app.main - Initialising Ira API application
2025-12-20 22:53:30,882 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:53:30,882 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:53:30,887 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:53:30,888 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 30, in metrics_scheduler
    metrics_service = SystemMetricsService(session)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 18, in __init__
    self.internet_metrics_service = InternetMetricsService()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.__init__() missing 1 required keyword-only argument: 'ping_host'
2025-12-20 22:53:33,060 [INFO] app.main - Initialising Ira API application
2025-12-20 22:53:33,060 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:53:33,061 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:53:33,066 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:53:33,067 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 30, in metrics_scheduler
    metrics_service = SystemMetricsService(session)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 18, in __init__
    self.internet_metrics_service = InternetMetricsService()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.__init__() missing 1 required keyword-only argument: 'ping_host'
2025-12-20 22:53:34,043 [INFO] app.main - Initialising Ira API application
2025-12-20 22:53:34,043 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:53:34,043 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:53:34,049 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:53:34,050 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 30, in metrics_scheduler
    metrics_service = SystemMetricsService(session)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 18, in __init__
    self.internet_metrics_service = InternetMetricsService()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.__init__() missing 1 required keyword-only argument: 'ping_host'
2025-12-20 22:53:37,817 [INFO] app.main - Initialising Ira API application
2025-12-20 22:53:37,818 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:53:37,818 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:53:37,823 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:53:37,823 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 30, in metrics_scheduler
    metrics_service = SystemMetricsService(session)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 18, in __init__
    self.internet_metrics_service = InternetMetricsService()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.__init__() missing 1 required keyword-only argument: 'ping_host'
2025-12-20 22:53:42,824 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 30, in metrics_scheduler
    metrics_service = SystemMetricsService(session)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 18, in __init__
    self.internet_metrics_service = InternetMetricsService()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.__init__() missing 1 required keyword-only argument: 'ping_host'
2025-12-20 22:53:43,816 [INFO] app.main - Initialising Ira API application
2025-12-20 22:53:43,817 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:53:43,817 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:53:43,822 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:53:43,822 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 30, in metrics_scheduler
    metrics_service = SystemMetricsService(session)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 18, in __init__
    self.internet_metrics_service = InternetMetricsService("1.1.1.1")
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.__init__() takes 1 positional argument but 2 were given
2025-12-20 22:53:48,823 [ERROR] app.core.metrics_scheduler - metric collection failed for host DESKTOP-B5V272O
Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/core/metrics_scheduler.py", line 30, in metrics_scheduler
    metrics_service = SystemMetricsService(session)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/app/services/metrics/metrics_service.py", line 18, in __init__
    self.internet_metrics_service = InternetMetricsService("1.1.1.1")
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: InternetMetricsService.__init__() takes 1 positional argument but 2 were given
2025-12-20 22:53:53,249 [INFO] app.main - Initialising Ira API application
2025-12-20 22:53:53,249 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:53:53,249 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:53:53,254 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 22:53:57,442 [ERROR] app.services.system_alerts_service - Failed to persist alert memory.available.percent for DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 53, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 53, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/services/system_alerts_service.py", line 84, in _save_critical_alert
    await self.alerts_repository.insert_critical(
  File "/home/markus/projects/IRANet/ira/app/repositories/system_alerts.py", line 62, in insert_critical
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 53, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO system_alerts (id, host, metric, level, value, threshold, status, message, first_seen_at, last_seen_at, resolved_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::FLOAT, $7::VARCHAR, $8::VARCHAR, $9::TIMESTAMP WITHOUT TIME ZONE, $10::TIMESTAMP WITHOUT TIME ZONE, $11::TIMESTAMP WITHOUT TIME ZONE)]
[parameters: (UUID('81005726-188f-4606-9746-7b47da1d5373'), 'DESKTOP-B5V272O', 'memory.available.percent', 'critical', 79.96, 80, 'active', 'Low available memory: 79.96%', datetime.datetime(2025, 12, 20, 22, 53, 57, 439806, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 12, 20, 22, 53, 57, 439806, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 22:53:57,447 [INFO] app.services.system_alerts_service - Broadcasted critical alert memory.available.percent for DESKTOP-B5V272O: Low available memory: 79.96%
2025-12-20 22:54:06,591 [ERROR] app.services.system_alerts_service - Failed to persist alert memory.available.percent for DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 54, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 54, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/services/system_alerts_service.py", line 84, in _save_critical_alert
    await self.alerts_repository.insert_critical(
  File "/home/markus/projects/IRANet/ira/app/repositories/system_alerts.py", line 62, in insert_critical
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 54, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO system_alerts (id, host, metric, level, value, threshold, status, message, first_seen_at, last_seen_at, resolved_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::FLOAT, $7::VARCHAR, $8::VARCHAR, $9::TIMESTAMP WITHOUT TIME ZONE, $10::TIMESTAMP WITHOUT TIME ZONE, $11::TIMESTAMP WITHOUT TIME ZONE)]
[parameters: (UUID('307e0102-5348-4eb3-a908-4b6a7d8b8ae0'), 'DESKTOP-B5V272O', 'memory.available.percent', 'critical', 79.91, 80, 'active', 'Low available memory: 79.91%', datetime.datetime(2025, 12, 20, 22, 54, 6, 590306, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 12, 20, 22, 54, 6, 590306, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 22:54:06,593 [INFO] app.services.system_alerts_service - Broadcasted critical alert memory.available.percent for DESKTOP-B5V272O: Low available memory: 79.91%
2025-12-20 22:54:15,738 [ERROR] app.services.system_alerts_service - Failed to persist alert memory.available.percent for DESKTOP-B5V272O
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 54, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 54, ... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/markus/projects/IRANet/ira/app/services/system_alerts_service.py", line 84, in _save_critical_alert
    await self.alerts_repository.insert_critical(
  File "/home/markus/projects/IRANet/ira/app/repositories/system_alerts.py", line 62, in insert_critical
    await self._session.commit()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/home/markus/projects/IRANet/ira/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $9: datetime.datetime(2025, 12, 20, 22, 54, ... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO system_alerts (id, host, metric, level, value, threshold, status, message, first_seen_at, last_seen_at, resolved_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::FLOAT, $7::VARCHAR, $8::VARCHAR, $9::TIMESTAMP WITHOUT TIME ZONE, $10::TIMESTAMP WITHOUT TIME ZONE, $11::TIMESTAMP WITHOUT TIME ZONE)]
[parameters: (UUID('03a653e3-6529-407f-b101-8ca1117851e4'), 'DESKTOP-B5V272O', 'memory.available.percent', 'critical', 79.87, 80, 'active', 'Low available memory: 79.87%', datetime.datetime(2025, 12, 20, 22, 54, 15, 736393, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 12, 20, 22, 54, 15, 736393, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 22:54:15,740 [INFO] app.services.system_alerts_service - Broadcasted critical alert memory.available.percent for DESKTOP-B5V272O: Low available memory: 79.87%
2025-12-20 22:54:44,994 [INFO] app.main - Initialising Ira API application
2025-12-20 22:54:44,994 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 22:54:44,994 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 22:54:45,001 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:02:33,209 [INFO] app.main - Initialising Ira API application
2025-12-20 23:02:33,209 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:02:33,209 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:02:33,214 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:05:55,077 [INFO] app.main - Initialising Ira API application
2025-12-20 23:05:55,077 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:05:55,077 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:05:55,083 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:12:12,812 [INFO] app.main - Initialising Ira API application
2025-12-20 23:12:12,812 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:12:12,813 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:12:12,818 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:13:36,793 [INFO] app.main - Initialising Ira API application
2025-12-20 23:13:36,793 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:13:36,794 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:13:36,810 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:13:38,417 [INFO] app.main - Initialising Ira API application
2025-12-20 23:13:38,418 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:13:38,418 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:13:38,424 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:13:56,489 [INFO] app.main - Initialising Ira API application
2025-12-20 23:13:56,489 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:13:56,489 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:13:56,494 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:14:36,911 [INFO] app.main - Initialising Ira API application
2025-12-20 23:14:36,911 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:14:36,912 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:14:36,917 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:14:48,799 [INFO] app.main - Initialising Ira API application
2025-12-20 23:14:48,800 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:14:48,800 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:14:48,807 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:49:19,925 [INFO] app.main - Initialising Ira API application
2025-12-20 23:49:19,925 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:49:19,926 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:49:19,933 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:49:22,402 [INFO] app.main - Initialising Ira API application
2025-12-20 23:49:22,402 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:49:22,402 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:49:22,409 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:49:35,119 [INFO] app.main - Initialising Ira API application
2025-12-20 23:49:35,120 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:49:35,120 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:49:35,126 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:49:36,506 [INFO] app.main - Initialising Ira API application
2025-12-20 23:49:36,506 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:49:36,506 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:49:36,511 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:49:57,254 [INFO] app.main - Initialising Ira API application
2025-12-20 23:49:57,255 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:49:57,255 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:49:57,260 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:49:58,510 [INFO] app.main - Initialising Ira API application
2025-12-20 23:49:58,510 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:49:58,510 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:49:58,515 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:52:05,696 [INFO] app.main - Initialising Ira API application
2025-12-20 23:52:05,697 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:52:05,697 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:52:05,703 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:54:58,131 [INFO] app.main - Initialising Ira API application
2025-12-20 23:54:58,131 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:54:58,132 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:54:58,137 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:54:58,907 [INFO] app.main - Initialising Ira API application
2025-12-20 23:54:58,907 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:54:58,907 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:54:58,915 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:55:18,511 [INFO] app.main - Initialising Ira API application
2025-12-20 23:55:18,512 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:55:18,514 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:55:18,522 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:55:20,955 [INFO] app.main - Initialising Ira API application
2025-12-20 23:55:20,955 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:55:20,955 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:55:20,961 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:57:17,635 [INFO] app.main - Initialising Ira API application
2025-12-20 23:57:17,635 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:57:17,636 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:57:17,641 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:57:19,582 [INFO] app.main - Initialising Ira API application
2025-12-20 23:57:19,582 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:57:19,582 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:57:19,587 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:57:21,469 [INFO] app.main - Initialising Ira API application
2025-12-20 23:57:21,470 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:57:21,470 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:57:21,478 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:57:23,362 [INFO] app.main - Initialising Ira API application
2025-12-20 23:57:23,362 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:57:23,362 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:57:23,367 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:57:50,455 [INFO] app.main - Initialising Ira API application
2025-12-20 23:57:50,455 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:57:50,455 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:57:50,461 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:57:53,009 [INFO] app.main - Initialising Ira API application
2025-12-20 23:57:53,010 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:57:53,010 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:57:53,015 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:57:54,634 [INFO] app.main - Initialising Ira API application
2025-12-20 23:57:54,634 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:57:54,635 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:57:54,641 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:58:34,973 [INFO] app.main - Initialising Ira API application
2025-12-20 23:58:34,974 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:58:34,974 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:58:34,981 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:58:39,151 [INFO] app.main - Initialising Ira API application
2025-12-20 23:58:39,152 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:58:39,152 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:58:39,159 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:59:00,965 [INFO] app.main - Initialising Ira API application
2025-12-20 23:59:00,965 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:59:00,965 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:59:00,971 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
2025-12-20 23:59:04,742 [INFO] app.main - Initialising Ira API application
2025-12-20 23:59:04,742 [INFO] app.core.config - Loading configuration from default path: /home/markus/projects/IRANet/ira/app/config/ira.config.json
2025-12-20 23:59:04,742 [INFO] app.core.config - Configuration loaded successfully
2025-12-20 23:59:04,748 [INFO] app.core.metrics_scheduler - starting metrics scheduler for host DESKTOP-B5V272O
